<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding an manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <!-- Use the .htaccess and remove these lines to avoid edge case issues.
       More info: h5bp.com/b/378 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>zepto |  Patrick Ran</title>
  <meta name="author" content="Patrick Ran">
  

  
  <!-- Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->

  <!-- CSS: implied media=all -->
  <!-- CSS concatenated and minified via ant build script-->
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
  <!-- end CSS-->

  <!-- More ideas for your <head> here: h5bp.com/d/head-Tips &#8211;>

  <!-- All JavaScript at the bottom, except for Modernizr / Respond.
       Modernizr enables HTML5 elements & feature detects; Respond is a polyfill for min/max-width CSS3 Media Queries
       For optimal performance, use a custom Modernizr build: www.modernizr.com/download/ -->
  <script src="/javascripts/libs/modernizr-2.0.6.min.js"></script>
</head>

<body id="article">

  <div id="container" style="margin-top: 30px;">
    <nav role="navigation" ><ul class="main-navigation">
  <li style='float:left;margin-right:5px'><a class='nav' href="http://mirreal.net/">HOME</a></li>
  <li style="float:left;margin-right:7px"><a class="nav" href="/">BLOG</a></li>
  <li style='float:left;margin-right:7px'><a class='nav' href="/archives">ARCHIVES</a></li>
  <li style="float:left;margin-right:7px"><a class="nav" href="/note">NOTE</a></li>
  <li style="float:left;margin-right:7px"><a class="nav" href="/weekly">WEEKLY</a></li>
  <li style="float:left;margin-right:7px"><a class="nav" href="/project">PROJECT</a></li>
  <li style="float:left;margin-right:7px"><a class="nav" href="/about">ABOUT</a></li>
</ul>
<br><br>
</nav>
    <article>
  <h1 class="article-title">Zepto</h1>
  <div class="sharing">
  
  
</div>

  <div class="article-content"><h2>版本 1.1.6</h2>

<h2>source code</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
<span class='line-number'>429</span>
<span class='line-number'>430</span>
<span class='line-number'>431</span>
<span class='line-number'>432</span>
<span class='line-number'>433</span>
<span class='line-number'>434</span>
<span class='line-number'>435</span>
<span class='line-number'>436</span>
<span class='line-number'>437</span>
<span class='line-number'>438</span>
<span class='line-number'>439</span>
<span class='line-number'>440</span>
<span class='line-number'>441</span>
<span class='line-number'>442</span>
<span class='line-number'>443</span>
<span class='line-number'>444</span>
<span class='line-number'>445</span>
<span class='line-number'>446</span>
<span class='line-number'>447</span>
<span class='line-number'>448</span>
<span class='line-number'>449</span>
<span class='line-number'>450</span>
<span class='line-number'>451</span>
<span class='line-number'>452</span>
<span class='line-number'>453</span>
<span class='line-number'>454</span>
<span class='line-number'>455</span>
<span class='line-number'>456</span>
<span class='line-number'>457</span>
<span class='line-number'>458</span>
<span class='line-number'>459</span>
<span class='line-number'>460</span>
<span class='line-number'>461</span>
<span class='line-number'>462</span>
<span class='line-number'>463</span>
<span class='line-number'>464</span>
<span class='line-number'>465</span>
<span class='line-number'>466</span>
<span class='line-number'>467</span>
<span class='line-number'>468</span>
<span class='line-number'>469</span>
<span class='line-number'>470</span>
<span class='line-number'>471</span>
<span class='line-number'>472</span>
<span class='line-number'>473</span>
<span class='line-number'>474</span>
<span class='line-number'>475</span>
<span class='line-number'>476</span>
<span class='line-number'>477</span>
<span class='line-number'>478</span>
<span class='line-number'>479</span>
<span class='line-number'>480</span>
<span class='line-number'>481</span>
<span class='line-number'>482</span>
<span class='line-number'>483</span>
<span class='line-number'>484</span>
<span class='line-number'>485</span>
<span class='line-number'>486</span>
<span class='line-number'>487</span>
<span class='line-number'>488</span>
<span class='line-number'>489</span>
<span class='line-number'>490</span>
<span class='line-number'>491</span>
<span class='line-number'>492</span>
<span class='line-number'>493</span>
<span class='line-number'>494</span>
<span class='line-number'>495</span>
<span class='line-number'>496</span>
<span class='line-number'>497</span>
<span class='line-number'>498</span>
<span class='line-number'>499</span>
<span class='line-number'>500</span>
<span class='line-number'>501</span>
<span class='line-number'>502</span>
<span class='line-number'>503</span>
<span class='line-number'>504</span>
<span class='line-number'>505</span>
<span class='line-number'>506</span>
<span class='line-number'>507</span>
<span class='line-number'>508</span>
<span class='line-number'>509</span>
<span class='line-number'>510</span>
<span class='line-number'>511</span>
<span class='line-number'>512</span>
<span class='line-number'>513</span>
<span class='line-number'>514</span>
<span class='line-number'>515</span>
<span class='line-number'>516</span>
<span class='line-number'>517</span>
<span class='line-number'>518</span>
<span class='line-number'>519</span>
<span class='line-number'>520</span>
<span class='line-number'>521</span>
<span class='line-number'>522</span>
<span class='line-number'>523</span>
<span class='line-number'>524</span>
<span class='line-number'>525</span>
<span class='line-number'>526</span>
<span class='line-number'>527</span>
<span class='line-number'>528</span>
<span class='line-number'>529</span>
<span class='line-number'>530</span>
<span class='line-number'>531</span>
<span class='line-number'>532</span>
<span class='line-number'>533</span>
<span class='line-number'>534</span>
<span class='line-number'>535</span>
<span class='line-number'>536</span>
<span class='line-number'>537</span>
<span class='line-number'>538</span>
<span class='line-number'>539</span>
<span class='line-number'>540</span>
<span class='line-number'>541</span>
<span class='line-number'>542</span>
<span class='line-number'>543</span>
<span class='line-number'>544</span>
<span class='line-number'>545</span>
<span class='line-number'>546</span>
<span class='line-number'>547</span>
<span class='line-number'>548</span>
<span class='line-number'>549</span>
<span class='line-number'>550</span>
<span class='line-number'>551</span>
<span class='line-number'>552</span>
<span class='line-number'>553</span>
<span class='line-number'>554</span>
<span class='line-number'>555</span>
<span class='line-number'>556</span>
<span class='line-number'>557</span>
<span class='line-number'>558</span>
<span class='line-number'>559</span>
<span class='line-number'>560</span>
<span class='line-number'>561</span>
<span class='line-number'>562</span>
<span class='line-number'>563</span>
<span class='line-number'>564</span>
<span class='line-number'>565</span>
<span class='line-number'>566</span>
<span class='line-number'>567</span>
<span class='line-number'>568</span>
<span class='line-number'>569</span>
<span class='line-number'>570</span>
<span class='line-number'>571</span>
<span class='line-number'>572</span>
<span class='line-number'>573</span>
<span class='line-number'>574</span>
<span class='line-number'>575</span>
<span class='line-number'>576</span>
<span class='line-number'>577</span>
<span class='line-number'>578</span>
<span class='line-number'>579</span>
<span class='line-number'>580</span>
<span class='line-number'>581</span>
<span class='line-number'>582</span>
<span class='line-number'>583</span>
<span class='line-number'>584</span>
<span class='line-number'>585</span>
<span class='line-number'>586</span>
<span class='line-number'>587</span>
<span class='line-number'>588</span>
<span class='line-number'>589</span>
<span class='line-number'>590</span>
<span class='line-number'>591</span>
<span class='line-number'>592</span>
<span class='line-number'>593</span>
<span class='line-number'>594</span>
<span class='line-number'>595</span>
<span class='line-number'>596</span>
<span class='line-number'>597</span>
<span class='line-number'>598</span>
<span class='line-number'>599</span>
<span class='line-number'>600</span>
<span class='line-number'>601</span>
<span class='line-number'>602</span>
<span class='line-number'>603</span>
<span class='line-number'>604</span>
<span class='line-number'>605</span>
<span class='line-number'>606</span>
<span class='line-number'>607</span>
<span class='line-number'>608</span>
<span class='line-number'>609</span>
<span class='line-number'>610</span>
<span class='line-number'>611</span>
<span class='line-number'>612</span>
<span class='line-number'>613</span>
<span class='line-number'>614</span>
<span class='line-number'>615</span>
<span class='line-number'>616</span>
<span class='line-number'>617</span>
<span class='line-number'>618</span>
<span class='line-number'>619</span>
<span class='line-number'>620</span>
<span class='line-number'>621</span>
<span class='line-number'>622</span>
<span class='line-number'>623</span>
<span class='line-number'>624</span>
<span class='line-number'>625</span>
<span class='line-number'>626</span>
<span class='line-number'>627</span>
<span class='line-number'>628</span>
<span class='line-number'>629</span>
<span class='line-number'>630</span>
<span class='line-number'>631</span>
<span class='line-number'>632</span>
<span class='line-number'>633</span>
<span class='line-number'>634</span>
<span class='line-number'>635</span>
<span class='line-number'>636</span>
<span class='line-number'>637</span>
<span class='line-number'>638</span>
<span class='line-number'>639</span>
<span class='line-number'>640</span>
<span class='line-number'>641</span>
<span class='line-number'>642</span>
<span class='line-number'>643</span>
<span class='line-number'>644</span>
<span class='line-number'>645</span>
<span class='line-number'>646</span>
<span class='line-number'>647</span>
<span class='line-number'>648</span>
<span class='line-number'>649</span>
<span class='line-number'>650</span>
<span class='line-number'>651</span>
<span class='line-number'>652</span>
<span class='line-number'>653</span>
<span class='line-number'>654</span>
<span class='line-number'>655</span>
<span class='line-number'>656</span>
<span class='line-number'>657</span>
<span class='line-number'>658</span>
<span class='line-number'>659</span>
<span class='line-number'>660</span>
<span class='line-number'>661</span>
<span class='line-number'>662</span>
<span class='line-number'>663</span>
<span class='line-number'>664</span>
<span class='line-number'>665</span>
<span class='line-number'>666</span>
<span class='line-number'>667</span>
<span class='line-number'>668</span>
<span class='line-number'>669</span>
<span class='line-number'>670</span>
<span class='line-number'>671</span>
<span class='line-number'>672</span>
<span class='line-number'>673</span>
<span class='line-number'>674</span>
<span class='line-number'>675</span>
<span class='line-number'>676</span>
<span class='line-number'>677</span>
<span class='line-number'>678</span>
<span class='line-number'>679</span>
<span class='line-number'>680</span>
<span class='line-number'>681</span>
<span class='line-number'>682</span>
<span class='line-number'>683</span>
<span class='line-number'>684</span>
<span class='line-number'>685</span>
<span class='line-number'>686</span>
<span class='line-number'>687</span>
<span class='line-number'>688</span>
<span class='line-number'>689</span>
<span class='line-number'>690</span>
<span class='line-number'>691</span>
<span class='line-number'>692</span>
<span class='line-number'>693</span>
<span class='line-number'>694</span>
<span class='line-number'>695</span>
<span class='line-number'>696</span>
<span class='line-number'>697</span>
<span class='line-number'>698</span>
<span class='line-number'>699</span>
<span class='line-number'>700</span>
<span class='line-number'>701</span>
<span class='line-number'>702</span>
<span class='line-number'>703</span>
<span class='line-number'>704</span>
<span class='line-number'>705</span>
<span class='line-number'>706</span>
<span class='line-number'>707</span>
<span class='line-number'>708</span>
<span class='line-number'>709</span>
<span class='line-number'>710</span>
<span class='line-number'>711</span>
<span class='line-number'>712</span>
<span class='line-number'>713</span>
<span class='line-number'>714</span>
<span class='line-number'>715</span>
<span class='line-number'>716</span>
<span class='line-number'>717</span>
<span class='line-number'>718</span>
<span class='line-number'>719</span>
<span class='line-number'>720</span>
<span class='line-number'>721</span>
<span class='line-number'>722</span>
<span class='line-number'>723</span>
<span class='line-number'>724</span>
<span class='line-number'>725</span>
<span class='line-number'>726</span>
<span class='line-number'>727</span>
<span class='line-number'>728</span>
<span class='line-number'>729</span>
<span class='line-number'>730</span>
<span class='line-number'>731</span>
<span class='line-number'>732</span>
<span class='line-number'>733</span>
<span class='line-number'>734</span>
<span class='line-number'>735</span>
<span class='line-number'>736</span>
<span class='line-number'>737</span>
<span class='line-number'>738</span>
<span class='line-number'>739</span>
<span class='line-number'>740</span>
<span class='line-number'>741</span>
<span class='line-number'>742</span>
<span class='line-number'>743</span>
<span class='line-number'>744</span>
<span class='line-number'>745</span>
<span class='line-number'>746</span>
<span class='line-number'>747</span>
<span class='line-number'>748</span>
<span class='line-number'>749</span>
<span class='line-number'>750</span>
<span class='line-number'>751</span>
<span class='line-number'>752</span>
<span class='line-number'>753</span>
<span class='line-number'>754</span>
<span class='line-number'>755</span>
<span class='line-number'>756</span>
<span class='line-number'>757</span>
<span class='line-number'>758</span>
<span class='line-number'>759</span>
<span class='line-number'>760</span>
<span class='line-number'>761</span>
<span class='line-number'>762</span>
<span class='line-number'>763</span>
<span class='line-number'>764</span>
<span class='line-number'>765</span>
<span class='line-number'>766</span>
<span class='line-number'>767</span>
<span class='line-number'>768</span>
<span class='line-number'>769</span>
<span class='line-number'>770</span>
<span class='line-number'>771</span>
<span class='line-number'>772</span>
<span class='line-number'>773</span>
<span class='line-number'>774</span>
<span class='line-number'>775</span>
<span class='line-number'>776</span>
<span class='line-number'>777</span>
<span class='line-number'>778</span>
<span class='line-number'>779</span>
<span class='line-number'>780</span>
<span class='line-number'>781</span>
<span class='line-number'>782</span>
<span class='line-number'>783</span>
<span class='line-number'>784</span>
<span class='line-number'>785</span>
<span class='line-number'>786</span>
<span class='line-number'>787</span>
<span class='line-number'>788</span>
<span class='line-number'>789</span>
<span class='line-number'>790</span>
<span class='line-number'>791</span>
<span class='line-number'>792</span>
<span class='line-number'>793</span>
<span class='line-number'>794</span>
<span class='line-number'>795</span>
<span class='line-number'>796</span>
<span class='line-number'>797</span>
<span class='line-number'>798</span>
<span class='line-number'>799</span>
<span class='line-number'>800</span>
<span class='line-number'>801</span>
<span class='line-number'>802</span>
<span class='line-number'>803</span>
<span class='line-number'>804</span>
<span class='line-number'>805</span>
<span class='line-number'>806</span>
<span class='line-number'>807</span>
<span class='line-number'>808</span>
<span class='line-number'>809</span>
<span class='line-number'>810</span>
<span class='line-number'>811</span>
<span class='line-number'>812</span>
<span class='line-number'>813</span>
<span class='line-number'>814</span>
<span class='line-number'>815</span>
<span class='line-number'>816</span>
<span class='line-number'>817</span>
<span class='line-number'>818</span>
<span class='line-number'>819</span>
<span class='line-number'>820</span>
<span class='line-number'>821</span>
<span class='line-number'>822</span>
<span class='line-number'>823</span>
<span class='line-number'>824</span>
<span class='line-number'>825</span>
<span class='line-number'>826</span>
<span class='line-number'>827</span>
<span class='line-number'>828</span>
<span class='line-number'>829</span>
<span class='line-number'>830</span>
<span class='line-number'>831</span>
<span class='line-number'>832</span>
<span class='line-number'>833</span>
<span class='line-number'>834</span>
<span class='line-number'>835</span>
<span class='line-number'>836</span>
<span class='line-number'>837</span>
<span class='line-number'>838</span>
<span class='line-number'>839</span>
<span class='line-number'>840</span>
<span class='line-number'>841</span>
<span class='line-number'>842</span>
<span class='line-number'>843</span>
<span class='line-number'>844</span>
<span class='line-number'>845</span>
<span class='line-number'>846</span>
<span class='line-number'>847</span>
<span class='line-number'>848</span>
<span class='line-number'>849</span>
<span class='line-number'>850</span>
<span class='line-number'>851</span>
<span class='line-number'>852</span>
<span class='line-number'>853</span>
<span class='line-number'>854</span>
<span class='line-number'>855</span>
<span class='line-number'>856</span>
<span class='line-number'>857</span>
<span class='line-number'>858</span>
<span class='line-number'>859</span>
<span class='line-number'>860</span>
<span class='line-number'>861</span>
<span class='line-number'>862</span>
<span class='line-number'>863</span>
<span class='line-number'>864</span>
<span class='line-number'>865</span>
<span class='line-number'>866</span>
<span class='line-number'>867</span>
<span class='line-number'>868</span>
<span class='line-number'>869</span>
<span class='line-number'>870</span>
<span class='line-number'>871</span>
<span class='line-number'>872</span>
<span class='line-number'>873</span>
<span class='line-number'>874</span>
<span class='line-number'>875</span>
<span class='line-number'>876</span>
<span class='line-number'>877</span>
<span class='line-number'>878</span>
<span class='line-number'>879</span>
<span class='line-number'>880</span>
<span class='line-number'>881</span>
<span class='line-number'>882</span>
<span class='line-number'>883</span>
<span class='line-number'>884</span>
<span class='line-number'>885</span>
<span class='line-number'>886</span>
<span class='line-number'>887</span>
<span class='line-number'>888</span>
<span class='line-number'>889</span>
<span class='line-number'>890</span>
<span class='line-number'>891</span>
<span class='line-number'>892</span>
<span class='line-number'>893</span>
<span class='line-number'>894</span>
<span class='line-number'>895</span>
<span class='line-number'>896</span>
<span class='line-number'>897</span>
<span class='line-number'>898</span>
<span class='line-number'>899</span>
<span class='line-number'>900</span>
<span class='line-number'>901</span>
<span class='line-number'>902</span>
<span class='line-number'>903</span>
<span class='line-number'>904</span>
<span class='line-number'>905</span>
<span class='line-number'>906</span>
<span class='line-number'>907</span>
<span class='line-number'>908</span>
<span class='line-number'>909</span>
<span class='line-number'>910</span>
<span class='line-number'>911</span>
<span class='line-number'>912</span>
<span class='line-number'>913</span>
<span class='line-number'>914</span>
<span class='line-number'>915</span>
<span class='line-number'>916</span>
<span class='line-number'>917</span>
<span class='line-number'>918</span>
<span class='line-number'>919</span>
<span class='line-number'>920</span>
<span class='line-number'>921</span>
<span class='line-number'>922</span>
<span class='line-number'>923</span>
<span class='line-number'>924</span>
<span class='line-number'>925</span>
<span class='line-number'>926</span>
<span class='line-number'>927</span>
<span class='line-number'>928</span>
<span class='line-number'>929</span>
<span class='line-number'>930</span>
<span class='line-number'>931</span>
<span class='line-number'>932</span>
<span class='line-number'>933</span>
<span class='line-number'>934</span>
<span class='line-number'>935</span>
<span class='line-number'>936</span>
<span class='line-number'>937</span>
<span class='line-number'>938</span>
<span class='line-number'>939</span>
<span class='line-number'>940</span>
<span class='line-number'>941</span>
<span class='line-number'>942</span>
<span class='line-number'>943</span>
<span class='line-number'>944</span>
<span class='line-number'>945</span>
<span class='line-number'>946</span>
<span class='line-number'>947</span>
<span class='line-number'>948</span>
<span class='line-number'>949</span>
<span class='line-number'>950</span>
<span class='line-number'>951</span>
<span class='line-number'>952</span>
<span class='line-number'>953</span>
<span class='line-number'>954</span>
<span class='line-number'>955</span>
<span class='line-number'>956</span>
<span class='line-number'>957</span>
<span class='line-number'>958</span>
<span class='line-number'>959</span>
<span class='line-number'>960</span>
<span class='line-number'>961</span>
<span class='line-number'>962</span>
<span class='line-number'>963</span>
<span class='line-number'>964</span>
<span class='line-number'>965</span>
<span class='line-number'>966</span>
<span class='line-number'>967</span>
<span class='line-number'>968</span>
<span class='line-number'>969</span>
<span class='line-number'>970</span>
<span class='line-number'>971</span>
<span class='line-number'>972</span>
<span class='line-number'>973</span>
<span class='line-number'>974</span>
<span class='line-number'>975</span>
<span class='line-number'>976</span>
<span class='line-number'>977</span>
<span class='line-number'>978</span>
<span class='line-number'>979</span>
<span class='line-number'>980</span>
<span class='line-number'>981</span>
<span class='line-number'>982</span>
<span class='line-number'>983</span>
<span class='line-number'>984</span>
<span class='line-number'>985</span>
<span class='line-number'>986</span>
<span class='line-number'>987</span>
<span class='line-number'>988</span>
<span class='line-number'>989</span>
<span class='line-number'>990</span>
<span class='line-number'>991</span>
<span class='line-number'>992</span>
<span class='line-number'>993</span>
<span class='line-number'>994</span>
<span class='line-number'>995</span>
<span class='line-number'>996</span>
<span class='line-number'>997</span>
<span class='line-number'>998</span>
<span class='line-number'>999</span>
<span class='line-number'>1000</span>
<span class='line-number'>1001</span>
<span class='line-number'>1002</span>
<span class='line-number'>1003</span>
<span class='line-number'>1004</span>
<span class='line-number'>1005</span>
<span class='line-number'>1006</span>
<span class='line-number'>1007</span>
<span class='line-number'>1008</span>
<span class='line-number'>1009</span>
<span class='line-number'>1010</span>
<span class='line-number'>1011</span>
<span class='line-number'>1012</span>
<span class='line-number'>1013</span>
<span class='line-number'>1014</span>
<span class='line-number'>1015</span>
<span class='line-number'>1016</span>
<span class='line-number'>1017</span>
<span class='line-number'>1018</span>
<span class='line-number'>1019</span>
<span class='line-number'>1020</span>
<span class='line-number'>1021</span>
<span class='line-number'>1022</span>
<span class='line-number'>1023</span>
<span class='line-number'>1024</span>
<span class='line-number'>1025</span>
<span class='line-number'>1026</span>
<span class='line-number'>1027</span>
<span class='line-number'>1028</span>
<span class='line-number'>1029</span>
<span class='line-number'>1030</span>
<span class='line-number'>1031</span>
<span class='line-number'>1032</span>
<span class='line-number'>1033</span>
<span class='line-number'>1034</span>
<span class='line-number'>1035</span>
<span class='line-number'>1036</span>
<span class='line-number'>1037</span>
<span class='line-number'>1038</span>
<span class='line-number'>1039</span>
<span class='line-number'>1040</span>
<span class='line-number'>1041</span>
<span class='line-number'>1042</span>
<span class='line-number'>1043</span>
<span class='line-number'>1044</span>
<span class='line-number'>1045</span>
<span class='line-number'>1046</span>
<span class='line-number'>1047</span>
<span class='line-number'>1048</span>
<span class='line-number'>1049</span>
<span class='line-number'>1050</span>
<span class='line-number'>1051</span>
<span class='line-number'>1052</span>
<span class='line-number'>1053</span>
<span class='line-number'>1054</span>
<span class='line-number'>1055</span>
<span class='line-number'>1056</span>
<span class='line-number'>1057</span>
<span class='line-number'>1058</span>
<span class='line-number'>1059</span>
<span class='line-number'>1060</span>
<span class='line-number'>1061</span>
<span class='line-number'>1062</span>
<span class='line-number'>1063</span>
<span class='line-number'>1064</span>
<span class='line-number'>1065</span>
<span class='line-number'>1066</span>
<span class='line-number'>1067</span>
<span class='line-number'>1068</span>
<span class='line-number'>1069</span>
<span class='line-number'>1070</span>
<span class='line-number'>1071</span>
<span class='line-number'>1072</span>
<span class='line-number'>1073</span>
<span class='line-number'>1074</span>
<span class='line-number'>1075</span>
<span class='line-number'>1076</span>
<span class='line-number'>1077</span>
<span class='line-number'>1078</span>
<span class='line-number'>1079</span>
<span class='line-number'>1080</span>
<span class='line-number'>1081</span>
<span class='line-number'>1082</span>
<span class='line-number'>1083</span>
<span class='line-number'>1084</span>
<span class='line-number'>1085</span>
<span class='line-number'>1086</span>
<span class='line-number'>1087</span>
<span class='line-number'>1088</span>
<span class='line-number'>1089</span>
<span class='line-number'>1090</span>
<span class='line-number'>1091</span>
<span class='line-number'>1092</span>
<span class='line-number'>1093</span>
<span class='line-number'>1094</span>
<span class='line-number'>1095</span>
<span class='line-number'>1096</span>
<span class='line-number'>1097</span>
<span class='line-number'>1098</span>
<span class='line-number'>1099</span>
<span class='line-number'>1100</span>
<span class='line-number'>1101</span>
<span class='line-number'>1102</span>
<span class='line-number'>1103</span>
<span class='line-number'>1104</span>
<span class='line-number'>1105</span>
<span class='line-number'>1106</span>
<span class='line-number'>1107</span>
<span class='line-number'>1108</span>
<span class='line-number'>1109</span>
<span class='line-number'>1110</span>
<span class='line-number'>1111</span>
<span class='line-number'>1112</span>
<span class='line-number'>1113</span>
<span class='line-number'>1114</span>
<span class='line-number'>1115</span>
<span class='line-number'>1116</span>
<span class='line-number'>1117</span>
<span class='line-number'>1118</span>
<span class='line-number'>1119</span>
<span class='line-number'>1120</span>
<span class='line-number'>1121</span>
<span class='line-number'>1122</span>
<span class='line-number'>1123</span>
<span class='line-number'>1124</span>
<span class='line-number'>1125</span>
<span class='line-number'>1126</span>
<span class='line-number'>1127</span>
<span class='line-number'>1128</span>
<span class='line-number'>1129</span>
<span class='line-number'>1130</span>
<span class='line-number'>1131</span>
<span class='line-number'>1132</span>
<span class='line-number'>1133</span>
<span class='line-number'>1134</span>
<span class='line-number'>1135</span>
<span class='line-number'>1136</span>
<span class='line-number'>1137</span>
<span class='line-number'>1138</span>
<span class='line-number'>1139</span>
<span class='line-number'>1140</span>
<span class='line-number'>1141</span>
<span class='line-number'>1142</span>
<span class='line-number'>1143</span>
<span class='line-number'>1144</span>
<span class='line-number'>1145</span>
<span class='line-number'>1146</span>
<span class='line-number'>1147</span>
<span class='line-number'>1148</span>
<span class='line-number'>1149</span>
<span class='line-number'>1150</span>
<span class='line-number'>1151</span>
<span class='line-number'>1152</span>
<span class='line-number'>1153</span>
<span class='line-number'>1154</span>
<span class='line-number'>1155</span>
<span class='line-number'>1156</span>
<span class='line-number'>1157</span>
<span class='line-number'>1158</span>
<span class='line-number'>1159</span>
<span class='line-number'>1160</span>
<span class='line-number'>1161</span>
<span class='line-number'>1162</span>
<span class='line-number'>1163</span>
<span class='line-number'>1164</span>
<span class='line-number'>1165</span>
<span class='line-number'>1166</span>
<span class='line-number'>1167</span>
<span class='line-number'>1168</span>
<span class='line-number'>1169</span>
<span class='line-number'>1170</span>
<span class='line-number'>1171</span>
<span class='line-number'>1172</span>
<span class='line-number'>1173</span>
<span class='line-number'>1174</span>
<span class='line-number'>1175</span>
<span class='line-number'>1176</span>
<span class='line-number'>1177</span>
<span class='line-number'>1178</span>
<span class='line-number'>1179</span>
<span class='line-number'>1180</span>
<span class='line-number'>1181</span>
<span class='line-number'>1182</span>
<span class='line-number'>1183</span>
<span class='line-number'>1184</span>
<span class='line-number'>1185</span>
<span class='line-number'>1186</span>
<span class='line-number'>1187</span>
<span class='line-number'>1188</span>
<span class='line-number'>1189</span>
<span class='line-number'>1190</span>
<span class='line-number'>1191</span>
<span class='line-number'>1192</span>
<span class='line-number'>1193</span>
<span class='line-number'>1194</span>
<span class='line-number'>1195</span>
<span class='line-number'>1196</span>
<span class='line-number'>1197</span>
<span class='line-number'>1198</span>
<span class='line-number'>1199</span>
<span class='line-number'>1200</span>
<span class='line-number'>1201</span>
<span class='line-number'>1202</span>
<span class='line-number'>1203</span>
<span class='line-number'>1204</span>
<span class='line-number'>1205</span>
<span class='line-number'>1206</span>
<span class='line-number'>1207</span>
<span class='line-number'>1208</span>
<span class='line-number'>1209</span>
<span class='line-number'>1210</span>
<span class='line-number'>1211</span>
<span class='line-number'>1212</span>
<span class='line-number'>1213</span>
<span class='line-number'>1214</span>
<span class='line-number'>1215</span>
<span class='line-number'>1216</span>
<span class='line-number'>1217</span>
<span class='line-number'>1218</span>
<span class='line-number'>1219</span>
<span class='line-number'>1220</span>
<span class='line-number'>1221</span>
<span class='line-number'>1222</span>
<span class='line-number'>1223</span>
<span class='line-number'>1224</span>
<span class='line-number'>1225</span>
<span class='line-number'>1226</span>
<span class='line-number'>1227</span>
<span class='line-number'>1228</span>
<span class='line-number'>1229</span>
<span class='line-number'>1230</span>
<span class='line-number'>1231</span>
<span class='line-number'>1232</span>
<span class='line-number'>1233</span>
<span class='line-number'>1234</span>
<span class='line-number'>1235</span>
<span class='line-number'>1236</span>
<span class='line-number'>1237</span>
<span class='line-number'>1238</span>
<span class='line-number'>1239</span>
<span class='line-number'>1240</span>
<span class='line-number'>1241</span>
<span class='line-number'>1242</span>
<span class='line-number'>1243</span>
<span class='line-number'>1244</span>
<span class='line-number'>1245</span>
<span class='line-number'>1246</span>
<span class='line-number'>1247</span>
<span class='line-number'>1248</span>
<span class='line-number'>1249</span>
<span class='line-number'>1250</span>
<span class='line-number'>1251</span>
<span class='line-number'>1252</span>
<span class='line-number'>1253</span>
<span class='line-number'>1254</span>
<span class='line-number'>1255</span>
<span class='line-number'>1256</span>
<span class='line-number'>1257</span>
<span class='line-number'>1258</span>
<span class='line-number'>1259</span>
<span class='line-number'>1260</span>
<span class='line-number'>1261</span>
<span class='line-number'>1262</span>
<span class='line-number'>1263</span>
<span class='line-number'>1264</span>
<span class='line-number'>1265</span>
<span class='line-number'>1266</span>
<span class='line-number'>1267</span>
<span class='line-number'>1268</span>
<span class='line-number'>1269</span>
<span class='line-number'>1270</span>
<span class='line-number'>1271</span>
<span class='line-number'>1272</span>
<span class='line-number'>1273</span>
<span class='line-number'>1274</span>
<span class='line-number'>1275</span>
<span class='line-number'>1276</span>
<span class='line-number'>1277</span>
<span class='line-number'>1278</span>
<span class='line-number'>1279</span>
<span class='line-number'>1280</span>
<span class='line-number'>1281</span>
<span class='line-number'>1282</span>
<span class='line-number'>1283</span>
<span class='line-number'>1284</span>
<span class='line-number'>1285</span>
<span class='line-number'>1286</span>
<span class='line-number'>1287</span>
<span class='line-number'>1288</span>
<span class='line-number'>1289</span>
<span class='line-number'>1290</span>
<span class='line-number'>1291</span>
<span class='line-number'>1292</span>
<span class='line-number'>1293</span>
<span class='line-number'>1294</span>
<span class='line-number'>1295</span>
<span class='line-number'>1296</span>
<span class='line-number'>1297</span>
<span class='line-number'>1298</span>
<span class='line-number'>1299</span>
<span class='line-number'>1300</span>
<span class='line-number'>1301</span>
<span class='line-number'>1302</span>
<span class='line-number'>1303</span>
<span class='line-number'>1304</span>
<span class='line-number'>1305</span>
<span class='line-number'>1306</span>
<span class='line-number'>1307</span>
<span class='line-number'>1308</span>
<span class='line-number'>1309</span>
<span class='line-number'>1310</span>
<span class='line-number'>1311</span>
<span class='line-number'>1312</span>
<span class='line-number'>1313</span>
<span class='line-number'>1314</span>
<span class='line-number'>1315</span>
<span class='line-number'>1316</span>
<span class='line-number'>1317</span>
<span class='line-number'>1318</span>
<span class='line-number'>1319</span>
<span class='line-number'>1320</span>
<span class='line-number'>1321</span>
<span class='line-number'>1322</span>
<span class='line-number'>1323</span>
<span class='line-number'>1324</span>
<span class='line-number'>1325</span>
<span class='line-number'>1326</span>
<span class='line-number'>1327</span>
<span class='line-number'>1328</span>
<span class='line-number'>1329</span>
<span class='line-number'>1330</span>
<span class='line-number'>1331</span>
<span class='line-number'>1332</span>
<span class='line-number'>1333</span>
<span class='line-number'>1334</span>
<span class='line-number'>1335</span>
<span class='line-number'>1336</span>
<span class='line-number'>1337</span>
<span class='line-number'>1338</span>
<span class='line-number'>1339</span>
<span class='line-number'>1340</span>
<span class='line-number'>1341</span>
<span class='line-number'>1342</span>
<span class='line-number'>1343</span>
<span class='line-number'>1344</span>
<span class='line-number'>1345</span>
<span class='line-number'>1346</span>
<span class='line-number'>1347</span>
<span class='line-number'>1348</span>
<span class='line-number'>1349</span>
<span class='line-number'>1350</span>
<span class='line-number'>1351</span>
<span class='line-number'>1352</span>
<span class='line-number'>1353</span>
<span class='line-number'>1354</span>
<span class='line-number'>1355</span>
<span class='line-number'>1356</span>
<span class='line-number'>1357</span>
<span class='line-number'>1358</span>
<span class='line-number'>1359</span>
<span class='line-number'>1360</span>
<span class='line-number'>1361</span>
<span class='line-number'>1362</span>
<span class='line-number'>1363</span>
<span class='line-number'>1364</span>
<span class='line-number'>1365</span>
<span class='line-number'>1366</span>
<span class='line-number'>1367</span>
<span class='line-number'>1368</span>
<span class='line-number'>1369</span>
<span class='line-number'>1370</span>
<span class='line-number'>1371</span>
<span class='line-number'>1372</span>
<span class='line-number'>1373</span>
<span class='line-number'>1374</span>
<span class='line-number'>1375</span>
<span class='line-number'>1376</span>
<span class='line-number'>1377</span>
<span class='line-number'>1378</span>
<span class='line-number'>1379</span>
<span class='line-number'>1380</span>
<span class='line-number'>1381</span>
<span class='line-number'>1382</span>
<span class='line-number'>1383</span>
<span class='line-number'>1384</span>
<span class='line-number'>1385</span>
<span class='line-number'>1386</span>
<span class='line-number'>1387</span>
<span class='line-number'>1388</span>
<span class='line-number'>1389</span>
<span class='line-number'>1390</span>
<span class='line-number'>1391</span>
<span class='line-number'>1392</span>
<span class='line-number'>1393</span>
<span class='line-number'>1394</span>
<span class='line-number'>1395</span>
<span class='line-number'>1396</span>
<span class='line-number'>1397</span>
<span class='line-number'>1398</span>
<span class='line-number'>1399</span>
<span class='line-number'>1400</span>
<span class='line-number'>1401</span>
<span class='line-number'>1402</span>
<span class='line-number'>1403</span>
<span class='line-number'>1404</span>
<span class='line-number'>1405</span>
<span class='line-number'>1406</span>
<span class='line-number'>1407</span>
<span class='line-number'>1408</span>
<span class='line-number'>1409</span>
<span class='line-number'>1410</span>
<span class='line-number'>1411</span>
<span class='line-number'>1412</span>
<span class='line-number'>1413</span>
<span class='line-number'>1414</span>
<span class='line-number'>1415</span>
<span class='line-number'>1416</span>
<span class='line-number'>1417</span>
<span class='line-number'>1418</span>
<span class='line-number'>1419</span>
<span class='line-number'>1420</span>
<span class='line-number'>1421</span>
<span class='line-number'>1422</span>
<span class='line-number'>1423</span>
<span class='line-number'>1424</span>
<span class='line-number'>1425</span>
<span class='line-number'>1426</span>
<span class='line-number'>1427</span>
<span class='line-number'>1428</span>
<span class='line-number'>1429</span>
<span class='line-number'>1430</span>
<span class='line-number'>1431</span>
<span class='line-number'>1432</span>
<span class='line-number'>1433</span>
<span class='line-number'>1434</span>
<span class='line-number'>1435</span>
<span class='line-number'>1436</span>
<span class='line-number'>1437</span>
<span class='line-number'>1438</span>
<span class='line-number'>1439</span>
<span class='line-number'>1440</span>
<span class='line-number'>1441</span>
<span class='line-number'>1442</span>
<span class='line-number'>1443</span>
<span class='line-number'>1444</span>
<span class='line-number'>1445</span>
<span class='line-number'>1446</span>
<span class='line-number'>1447</span>
<span class='line-number'>1448</span>
<span class='line-number'>1449</span>
<span class='line-number'>1450</span>
<span class='line-number'>1451</span>
<span class='line-number'>1452</span>
<span class='line-number'>1453</span>
<span class='line-number'>1454</span>
<span class='line-number'>1455</span>
<span class='line-number'>1456</span>
<span class='line-number'>1457</span>
<span class='line-number'>1458</span>
<span class='line-number'>1459</span>
<span class='line-number'>1460</span>
<span class='line-number'>1461</span>
<span class='line-number'>1462</span>
<span class='line-number'>1463</span>
<span class='line-number'>1464</span>
<span class='line-number'>1465</span>
<span class='line-number'>1466</span>
<span class='line-number'>1467</span>
<span class='line-number'>1468</span>
<span class='line-number'>1469</span>
<span class='line-number'>1470</span>
<span class='line-number'>1471</span>
<span class='line-number'>1472</span>
<span class='line-number'>1473</span>
<span class='line-number'>1474</span>
<span class='line-number'>1475</span>
<span class='line-number'>1476</span>
<span class='line-number'>1477</span>
<span class='line-number'>1478</span>
<span class='line-number'>1479</span>
<span class='line-number'>1480</span>
<span class='line-number'>1481</span>
<span class='line-number'>1482</span>
<span class='line-number'>1483</span>
<span class='line-number'>1484</span>
<span class='line-number'>1485</span>
<span class='line-number'>1486</span>
<span class='line-number'>1487</span>
<span class='line-number'>1488</span>
<span class='line-number'>1489</span>
<span class='line-number'>1490</span>
<span class='line-number'>1491</span>
<span class='line-number'>1492</span>
<span class='line-number'>1493</span>
<span class='line-number'>1494</span>
<span class='line-number'>1495</span>
<span class='line-number'>1496</span>
<span class='line-number'>1497</span>
<span class='line-number'>1498</span>
<span class='line-number'>1499</span>
<span class='line-number'>1500</span>
<span class='line-number'>1501</span>
<span class='line-number'>1502</span>
<span class='line-number'>1503</span>
<span class='line-number'>1504</span>
<span class='line-number'>1505</span>
<span class='line-number'>1506</span>
<span class='line-number'>1507</span>
<span class='line-number'>1508</span>
<span class='line-number'>1509</span>
<span class='line-number'>1510</span>
<span class='line-number'>1511</span>
<span class='line-number'>1512</span>
<span class='line-number'>1513</span>
<span class='line-number'>1514</span>
<span class='line-number'>1515</span>
<span class='line-number'>1516</span>
<span class='line-number'>1517</span>
<span class='line-number'>1518</span>
<span class='line-number'>1519</span>
<span class='line-number'>1520</span>
<span class='line-number'>1521</span>
<span class='line-number'>1522</span>
<span class='line-number'>1523</span>
<span class='line-number'>1524</span>
<span class='line-number'>1525</span>
<span class='line-number'>1526</span>
<span class='line-number'>1527</span>
<span class='line-number'>1528</span>
<span class='line-number'>1529</span>
<span class='line-number'>1530</span>
<span class='line-number'>1531</span>
<span class='line-number'>1532</span>
<span class='line-number'>1533</span>
<span class='line-number'>1534</span>
<span class='line-number'>1535</span>
<span class='line-number'>1536</span>
<span class='line-number'>1537</span>
<span class='line-number'>1538</span>
<span class='line-number'>1539</span>
<span class='line-number'>1540</span>
<span class='line-number'>1541</span>
<span class='line-number'>1542</span>
<span class='line-number'>1543</span>
<span class='line-number'>1544</span>
<span class='line-number'>1545</span>
<span class='line-number'>1546</span>
<span class='line-number'>1547</span>
<span class='line-number'>1548</span>
<span class='line-number'>1549</span>
<span class='line-number'>1550</span>
<span class='line-number'>1551</span>
<span class='line-number'>1552</span>
<span class='line-number'>1553</span>
<span class='line-number'>1554</span>
<span class='line-number'>1555</span>
<span class='line-number'>1556</span>
<span class='line-number'>1557</span>
<span class='line-number'>1558</span>
<span class='line-number'>1559</span>
<span class='line-number'>1560</span>
<span class='line-number'>1561</span>
<span class='line-number'>1562</span>
<span class='line-number'>1563</span>
<span class='line-number'>1564</span>
<span class='line-number'>1565</span>
<span class='line-number'>1566</span>
<span class='line-number'>1567</span>
<span class='line-number'>1568</span>
<span class='line-number'>1569</span>
<span class='line-number'>1570</span>
<span class='line-number'>1571</span>
<span class='line-number'>1572</span>
<span class='line-number'>1573</span>
<span class='line-number'>1574</span>
<span class='line-number'>1575</span>
<span class='line-number'>1576</span>
<span class='line-number'>1577</span>
<span class='line-number'>1578</span>
<span class='line-number'>1579</span>
<span class='line-number'>1580</span>
<span class='line-number'>1581</span>
<span class='line-number'>1582</span>
<span class='line-number'>1583</span>
<span class='line-number'>1584</span>
<span class='line-number'>1585</span>
<span class='line-number'>1586</span>
<span class='line-number'>1587</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="cm">/* Zepto v1.1.6 - zepto event ajax form ie - zeptojs.com/license */</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">Zepto</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">classList</span><span class="p">,</span> <span class="nx">emptyArray</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">slice</span> <span class="o">=</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">filter</span><span class="p">,</span>
</span><span class='line'>    <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">elementDisplay</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">classCache</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">cssNumber</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;column-count&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;font-weight&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;line-height&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;opacity&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z-index&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">fragmentRE</span> <span class="o">=</span> <span class="sr">/^\s*&lt;(\w+|!)[^&gt;]*&gt;/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">singleTagRE</span> <span class="o">=</span> <span class="sr">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;|)$/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tagExpanderRE</span> <span class="o">=</span> <span class="sr">/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^&gt;]*)\/&gt;/ig</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">rootNodeRE</span> <span class="o">=</span> <span class="sr">/^(?:body|html)$/i</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">capitalRE</span> <span class="o">=</span> <span class="sr">/([A-Z])/g</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// special attributes that should be get/set via method calls</span>
</span><span class='line'>    <span class="nx">methodAttributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;css&#39;</span><span class="p">,</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">adjacencyOperators</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;after&#39;</span><span class="p">,</span> <span class="s1">&#39;prepend&#39;</span><span class="p">,</span> <span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="s1">&#39;append&#39;</span> <span class="p">],</span>
</span><span class='line'>    <span class="nx">table</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nx">tableRow</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nx">containers</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="s1">&#39;tr&#39;</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="s1">&#39;tbody&#39;</span><span class="o">:</span> <span class="nx">table</span><span class="p">,</span> <span class="s1">&#39;thead&#39;</span><span class="o">:</span> <span class="nx">table</span><span class="p">,</span> <span class="s1">&#39;tfoot&#39;</span><span class="o">:</span> <span class="nx">table</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;td&#39;</span><span class="o">:</span> <span class="nx">tableRow</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="o">:</span> <span class="nx">tableRow</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;*&#39;</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">readyRE</span> <span class="o">=</span> <span class="sr">/complete|loaded|interactive/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">simpleSelectorRE</span> <span class="o">=</span> <span class="sr">/^[\w-]*$/</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">class2type</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">toString</span> <span class="o">=</span> <span class="nx">class2type</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">zepto</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">camelize</span><span class="p">,</span> <span class="nx">uniq</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tempParent</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="nx">propMap</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="s1">&#39;tabindex&#39;</span><span class="o">:</span> <span class="s1">&#39;tabIndex&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;readonly&#39;</span><span class="o">:</span> <span class="s1">&#39;readOnly&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;for&#39;</span><span class="o">:</span> <span class="s1">&#39;htmlFor&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;class&#39;</span><span class="o">:</span> <span class="s1">&#39;className&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;maxlength&#39;</span><span class="o">:</span> <span class="s1">&#39;maxLength&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;cellspacing&#39;</span><span class="o">:</span> <span class="s1">&#39;cellSpacing&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;cellpadding&#39;</span><span class="o">:</span> <span class="s1">&#39;cellPadding&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;rowspan&#39;</span><span class="o">:</span> <span class="s1">&#39;rowSpan&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;colspan&#39;</span><span class="o">:</span> <span class="s1">&#39;colSpan&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;usemap&#39;</span><span class="o">:</span> <span class="s1">&#39;useMap&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;frameborder&#39;</span><span class="o">:</span> <span class="s1">&#39;frameBorder&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;contenteditable&#39;</span><span class="o">:</span> <span class="s1">&#39;contentEditable&#39;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">isArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">||</span>
</span><span class='line'>      <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">){</span> <span class="k">return</span> <span class="nx">object</span> <span class="k">instanceof</span> <span class="nb">Array</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">matches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">selector</span> <span class="o">||</span> <span class="o">!</span><span class="nx">element</span> <span class="o">||</span> <span class="nx">element</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">matchesSelector</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">webkitMatchesSelector</span> <span class="o">||</span> <span class="nx">element</span><span class="p">.</span><span class="nx">mozMatchesSelector</span> <span class="o">||</span>
</span><span class='line'>                          <span class="nx">element</span><span class="p">.</span><span class="nx">oMatchesSelector</span> <span class="o">||</span> <span class="nx">element</span><span class="p">.</span><span class="nx">matchesSelector</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">matchesSelector</span><span class="p">)</span> <span class="k">return</span> <span class="nx">matchesSelector</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">// fall back to performing a selector:</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span> <span class="nx">temp</span> <span class="o">=</span> <span class="o">!</span><span class="nx">parent</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">temp</span><span class="p">)</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">tempParent</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">match</span> <span class="o">=</span> <span class="o">~</span><span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">selector</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">temp</span> <span class="o">&amp;&amp;</span> <span class="nx">tempParent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">match</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nb">String</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">class2type</span><span class="p">[</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)]</span> <span class="o">||</span> <span class="s2">&quot;object&quot;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">type</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;function&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">isWindow</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>     <span class="p">{</span> <span class="k">return</span> <span class="nx">obj</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span> <span class="o">==</span> <span class="nx">obj</span><span class="p">.</span><span class="nb">window</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">isDocument</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>   <span class="p">{</span> <span class="k">return</span> <span class="nx">obj</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">==</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">DOCUMENT_NODE</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>     <span class="p">{</span> <span class="k">return</span> <span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">likeArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="s1">&#39;number&#39;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">compact</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span> <span class="k">return</span> <span class="nx">item</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">})</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">flatten</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span> <span class="nx">array</span><span class="p">)</span> <span class="o">:</span> <span class="nx">array</span> <span class="p">}</span>
</span><span class='line'>  <span class="nx">camelize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span> <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-+(.)?/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">chr</span><span class="p">){</span> <span class="k">return</span> <span class="nx">chr</span> <span class="o">?</span> <span class="nx">chr</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">})</span> <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">dasherize</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/::/g</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([A-Z]+)([A-Z][a-z])/g</span><span class="p">,</span> <span class="s1">&#39;$1_$2&#39;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([a-z\d])([A-Z])/g</span><span class="p">,</span> <span class="s1">&#39;$1_$2&#39;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_/g</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">uniq</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">){</span> <span class="k">return</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">idx</span><span class="p">){</span> <span class="k">return</span> <span class="nx">array</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">==</span> <span class="nx">idx</span> <span class="p">})</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">classRE</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">classCache</span> <span class="o">?</span>
</span><span class='line'>      <span class="nx">classCache</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">:</span> <span class="p">(</span><span class="nx">classCache</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(^|\\s)&#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;(\\s|$)&#39;</span><span class="p">))</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">maybeAddPx</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;number&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">cssNumber</span><span class="p">[</span><span class="nx">dasherize</span><span class="p">(</span><span class="nx">name</span><span class="p">)])</span> <span class="o">?</span> <span class="nx">value</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="o">:</span> <span class="nx">value</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">defaultDisplay</span><span class="p">(</span><span class="nx">nodeName</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">display</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">elementDisplay</span><span class="p">[</span><span class="nx">nodeName</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">nodeName</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">display</span> <span class="o">=</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">display</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;block&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">elementDisplay</span><span class="p">[</span><span class="nx">nodeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">display</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">elementDisplay</span><span class="p">[</span><span class="nx">nodeName</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">children</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s1">&#39;children&#39;</span> <span class="k">in</span> <span class="nx">element</span> <span class="o">?</span>
</span><span class='line'>      <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">node</span> <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$.zepto.fragment` takes a html string and an optional tag name</span>
</span><span class='line'>  <span class="c1">// to generate DOM nodes nodes from the given html string.</span>
</span><span class='line'>  <span class="c1">// The generated DOM nodes are returned as an array.</span>
</span><span class='line'>  <span class="c1">// This function can be overriden in plugins for example to make</span>
</span><span class='line'>  <span class="c1">// it compatible with browsers that don&#39;t support the DOM fully.</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">dom</span><span class="p">,</span> <span class="nx">nodes</span><span class="p">,</span> <span class="nx">container</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// A special case optimization for a single tag</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">singleTagRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">html</span><span class="p">))</span> <span class="nx">dom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dom</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">html</span><span class="p">.</span><span class="nx">replace</span><span class="p">)</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">tagExpanderRE</span><span class="p">,</span> <span class="s2">&quot;&lt;$1&gt;&lt;/$2&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">fragmentRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">containers</span><span class="p">))</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">container</span> <span class="o">=</span> <span class="nx">containers</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>
</span><span class='line'>      <span class="nx">container</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">html</span>
</span><span class='line'>      <span class="nx">dom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">container</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">),</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">container</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">properties</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">dom</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">methodAttributes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">nodes</span><span class="p">[</span><span class="nx">key</span><span class="p">](</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>        <span class="k">else</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">dom</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$.zepto.Z` swaps out the prototype of the given `dom` array</span>
</span><span class='line'>  <span class="c1">// of nodes with `$.fn` and thus supplying all the Zepto functions</span>
</span><span class='line'>  <span class="c1">// to the array. Note that `__proto__` is not supported on Internet</span>
</span><span class='line'>  <span class="c1">// Explorer. This method can be overriden in plugins.</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">Z</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dom</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dom</span> <span class="o">=</span> <span class="nx">dom</span> <span class="o">||</span> <span class="p">[]</span>
</span><span class='line'>    <span class="nx">dom</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span>
</span><span class='line'>    <span class="nx">dom</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">dom</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$.zepto.isZ` should return `true` if the given object is a Zepto</span>
</span><span class='line'>  <span class="c1">// collection. This method can be overriden in plugins.</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">isZ</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">object</span> <span class="k">instanceof</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">Z</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$.zepto.init` is Zepto&#39;s counterpart to jQuery&#39;s `$.fn.init` and</span>
</span><span class='line'>  <span class="c1">// takes a CSS selector and an optional context (and handles various</span>
</span><span class='line'>  <span class="c1">// special cases).</span>
</span><span class='line'>  <span class="c1">// This method can be overriden in plugins.</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">dom</span>
</span><span class='line'>    <span class="c1">// If nothing given, return an empty Zepto collection</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">selector</span><span class="p">)</span> <span class="k">return</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">Z</span><span class="p">()</span>
</span><span class='line'>    <span class="c1">// Optimize for string selectors</span>
</span><span class='line'>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">selector</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span>
</span><span class='line'>      <span class="c1">// If it&#39;s a html fragment, create nodes from it</span>
</span><span class='line'>      <span class="c1">// Note: In both Chrome 21 and Firefox 15, DOM error 12</span>
</span><span class='line'>      <span class="c1">// is thrown if the fragment doesn&#39;t begin with &lt;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">fragmentRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">dom</span> <span class="o">=</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">fragment</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">,</span> <span class="nx">context</span><span class="p">),</span> <span class="nx">selector</span> <span class="o">=</span> <span class="kc">null</span>
</span><span class='line'>      <span class="c1">// If there&#39;s a context, create a collection on that context first, and select</span>
</span><span class='line'>      <span class="c1">// nodes from there</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">context</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">context</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">// If it&#39;s a CSS selector, use it to select nodes.</span>
</span><span class='line'>      <span class="k">else</span> <span class="nx">dom</span> <span class="o">=</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="c1">// If a function is given, call it when the DOM is ready</span>
</span><span class='line'>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">// If a Zepto collection is given, just return it</span>
</span><span class='line'>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">zepto</span><span class="p">.</span><span class="nx">isZ</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span> <span class="k">return</span> <span class="nx">selector</span>
</span><span class='line'>    <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// normalize array if an array of nodes is given</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span> <span class="nx">dom</span> <span class="o">=</span> <span class="nx">compact</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">// Wrap DOM nodes.</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">dom</span> <span class="o">=</span> <span class="p">[</span><span class="nx">selector</span><span class="p">],</span> <span class="nx">selector</span> <span class="o">=</span> <span class="kc">null</span>
</span><span class='line'>      <span class="c1">// If it&#39;s a html fragment, create nodes from it</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">fragmentRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">dom</span> <span class="o">=</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">fragment</span><span class="p">(</span><span class="nx">selector</span><span class="p">.</span><span class="nx">trim</span><span class="p">(),</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">,</span> <span class="nx">context</span><span class="p">),</span> <span class="nx">selector</span> <span class="o">=</span> <span class="kc">null</span>
</span><span class='line'>      <span class="c1">// If there&#39;s a context, create a collection on that context first, and select</span>
</span><span class='line'>      <span class="c1">// nodes from there</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">context</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">context</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">// And last but no least, if it&#39;s a CSS selector, use it to select nodes.</span>
</span><span class='line'>      <span class="k">else</span> <span class="nx">dom</span> <span class="o">=</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="c1">// create a new Zepto collection from the nodes found</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">Z</span><span class="p">(</span><span class="nx">dom</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$` will be the base `Zepto` object. When calling this</span>
</span><span class='line'>  <span class="c1">// function just call `$.zepto.init, which makes the implementation</span>
</span><span class='line'>  <span class="c1">// details of selecting nodes and creating Zepto collections</span>
</span><span class='line'>  <span class="c1">// patchable in plugins.</span>
</span><span class='line'>  <span class="nx">$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">source</span><span class="p">,</span> <span class="nx">deep</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">source</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">deep</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">||</span> <span class="nx">isArray</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">])))</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span>
</span><span class='line'>          <span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>        <span class="nx">extend</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">deep</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Copy all but undefined properties from one or more</span>
</span><span class='line'>  <span class="c1">// objects to the `target` object.</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">deep</span><span class="p">,</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">target</span> <span class="o">==</span> <span class="s1">&#39;boolean&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">deep</span> <span class="o">=</span> <span class="nx">target</span>
</span><span class='line'>      <span class="nx">target</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">args</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">arg</span><span class="p">){</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">arg</span><span class="p">,</span> <span class="nx">deep</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">target</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// `$.zepto.qsa` is Zepto&#39;s CSS selector implementation which</span>
</span><span class='line'>  <span class="c1">// uses `document.querySelectorAll` and optimizes for some special cases, like `#id`.</span>
</span><span class='line'>  <span class="c1">// This method can be overriden in plugins.</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">found</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">maybeID</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">maybeClass</span> <span class="o">=</span> <span class="o">!</span><span class="nx">maybeID</span> <span class="o">&amp;&amp;</span> <span class="nx">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">nameOnly</span> <span class="o">=</span> <span class="nx">maybeID</span> <span class="o">||</span> <span class="nx">maybeClass</span> <span class="o">?</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">selector</span><span class="p">,</span> <span class="c1">// Ensure that a 1 char tag name still gets checked</span>
</span><span class='line'>        <span class="nx">isSimple</span> <span class="o">=</span> <span class="nx">simpleSelectorRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">nameOnly</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span><span class="nx">isDocument</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isSimple</span> <span class="o">&amp;&amp;</span> <span class="nx">maybeID</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>      <span class="p">(</span> <span class="p">(</span><span class="nx">found</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">nameOnly</span><span class="p">))</span> <span class="o">?</span> <span class="p">[</span><span class="nx">found</span><span class="p">]</span> <span class="o">:</span> <span class="p">[]</span> <span class="p">)</span> <span class="o">:</span>
</span><span class='line'>      <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">9</span><span class="p">)</span> <span class="o">?</span> <span class="p">[]</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
</span><span class='line'>        <span class="nx">isSimple</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">maybeID</span> <span class="o">?</span>
</span><span class='line'>          <span class="nx">maybeClass</span> <span class="o">?</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">nameOnly</span><span class="p">)</span> <span class="o">:</span> <span class="c1">// If it&#39;s simple, it could be a class</span>
</span><span class='line'>          <span class="nx">element</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span> <span class="c1">// Or a tag</span>
</span><span class='line'>          <span class="nx">element</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="c1">// Or it&#39;s not simple, and we need to query all</span>
</span><span class='line'>      <span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">filtered</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">selector</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nx">nodes</span><span class="p">)</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">nodes</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">contains</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">contains</span> <span class="o">?</span>
</span><span class='line'>    <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">parent</span> <span class="o">!==</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span> <span class="o">:</span>
</span><span class='line'>    <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">while</span> <span class="p">(</span><span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">))</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="o">===</span> <span class="nx">parent</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">funcArg</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">arg</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">isFunction</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="o">?</span> <span class="nx">arg</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="o">:</span> <span class="nx">arg</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">setAttribute</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// access className property while respecting SVGAnimatedString</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">className</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">value</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">klass</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">svg</span>   <span class="o">=</span> <span class="nx">klass</span> <span class="o">&amp;&amp;</span> <span class="nx">klass</span><span class="p">.</span><span class="nx">baseVal</span> <span class="o">!==</span> <span class="kc">undefined</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">svg</span> <span class="o">?</span> <span class="nx">klass</span><span class="p">.</span><span class="nx">baseVal</span> <span class="o">:</span> <span class="nx">klass</span>
</span><span class='line'>    <span class="nx">svg</span> <span class="o">?</span> <span class="p">(</span><span class="nx">klass</span><span class="p">.</span><span class="nx">baseVal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">value</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// &quot;true&quot;  =&gt; true</span>
</span><span class='line'>  <span class="c1">// &quot;false&quot; =&gt; false</span>
</span><span class='line'>  <span class="c1">// &quot;null&quot;  =&gt; null</span>
</span><span class='line'>  <span class="c1">// &quot;42&quot;    =&gt; 42</span>
</span><span class='line'>  <span class="c1">// &quot;42.5&quot;  =&gt; 42.5</span>
</span><span class='line'>  <span class="c1">// &quot;08&quot;    =&gt; &quot;08&quot;</span>
</span><span class='line'>  <span class="c1">// JSON    =&gt; parse if valid</span>
</span><span class='line'>  <span class="c1">// String  =&gt; self</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">deserializeValue</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">value</span> <span class="o">?</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span> <span class="o">||</span>
</span><span class='line'>        <span class="p">(</span> <span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;null&quot;</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span>
</span><span class='line'>          <span class="o">+</span><span class="nx">value</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span> <span class="o">==</span> <span class="nx">value</span> <span class="o">?</span> <span class="o">+</span><span class="nx">value</span> <span class="o">:</span>
</span><span class='line'>          <span class="sr">/^[\[\{]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">value</span> <span class="p">)</span>
</span><span class='line'>        <span class="o">:</span> <span class="nx">value</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">value</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">type</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span> <span class="o">=</span> <span class="nx">isFunction</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">isWindow</span> <span class="o">=</span> <span class="nx">isWindow</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">=</span> <span class="nx">isArray</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">isPlainObject</span> <span class="o">=</span> <span class="nx">isPlainObject</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">isEmptyObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">name</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">true</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">array</span><span class="p">,</span> <span class="nx">i</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">camelCase</span> <span class="o">=</span> <span class="nx">camelize</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">trim</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">str</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// plugin compatibility</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">uuid</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">support</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">expr</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">map</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elements</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">key</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">likeArray</span><span class="p">(</span><span class="nx">elements</span><span class="p">))</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">values</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">elements</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">value</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">key</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">values</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">flatten</span><span class="p">(</span><span class="nx">values</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elements</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">key</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">likeArray</span><span class="p">(</span><span class="nx">elements</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="k">return</span> <span class="nx">elements</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">elements</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="k">return</span> <span class="nx">elements</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">elements</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">grep</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elements</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elements</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">JSON</span><span class="p">)</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Populate the class2type map</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;Boolean Number String Function Array Date RegExp Object Error&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">class2type</span><span class="p">[</span> <span class="s2">&quot;[object &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Define methods that will be available on all</span>
</span><span class='line'>  <span class="c1">// Zepto collections</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Because a collection acts like an array</span>
</span><span class='line'>    <span class="c1">// copy over these useful array functions.</span>
</span><span class='line'>    <span class="nx">forEach</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">forEach</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">reduce</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">reduce</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">push</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">push</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">sort</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">sort</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">indexOf</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">concat</span><span class="o">:</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">concat</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// `map` and `slice` in the jQuery API work differently</span>
</span><span class='line'>    <span class="c1">// from their array counterparts</span>
</span><span class='line'>    <span class="nx">map</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">){</span> <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="p">}))</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">slice</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">))</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">ready</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>      <span class="c1">// need to check if document.body exists for IE as that browser reports</span>
</span><span class='line'>      <span class="c1">// document ready when it hasn&#39;t yet created the body element</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">readyRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">readyState</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span>
</span><span class='line'>      <span class="k">else</span> <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;DOMContentLoaded&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">},</span> <span class="kc">false</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">idx</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="o">:</span> <span class="k">this</span><span class="p">[</span><span class="nx">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">idx</span> <span class="o">:</span> <span class="nx">idx</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">toArray</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">size</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">false</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">filter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="nx">selector</span><span class="p">))</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}))</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span><span class="nx">context</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">uniq</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span><span class="nx">context</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">is</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">not</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">nodes</span><span class="o">=</span><span class="p">[]</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">call</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">selector</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">idx</span><span class="p">))</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">excludes</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">selector</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">likeArray</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isFunction</span><span class="p">(</span><span class="nx">selector</span><span class="p">.</span><span class="nx">item</span><span class="p">))</span> <span class="o">?</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">excludes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">nodes</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">has</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">isObject</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">size</span><span class="p">()</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">eq</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">idx</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">idx</span><span class="p">)</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">idx</span><span class="p">,</span> <span class="o">+</span> <span class="nx">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">first</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">last</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">find</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">$this</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">selector</span><span class="p">)</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">$</span><span class="p">()</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">selector</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">result</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">some</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">$this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">){</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">selector</span><span class="p">))</span>
</span><span class='line'>      <span class="k">else</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">qsa</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">result</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">closest</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">collection</span> <span class="o">=</span> <span class="kc">false</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">selector</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>      <span class="k">while</span> <span class="p">(</span><span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">collection</span> <span class="o">?</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)))</span>
</span><span class='line'>        <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span> <span class="o">!==</span> <span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isDocument</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">parents</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">ancestors</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>      <span class="k">while</span> <span class="p">(</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">((</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isDocument</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">ancestors</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">ancestors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">node</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">filtered</span><span class="p">(</span><span class="nx">ancestors</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">parent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">filtered</span><span class="p">(</span><span class="nx">uniq</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;parentNode&#39;</span><span class="p">)),</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">children</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">filtered</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">children</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">}),</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">contents</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">siblings</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">filtered</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">el</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">children</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">){</span> <span class="k">return</span> <span class="nx">child</span><span class="o">!==</span><span class="nx">el</span> <span class="p">})</span>
</span><span class='line'>      <span class="p">}),</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">empty</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="c1">// `pluck` is borrowed from Prototype.js</span>
</span><span class='line'>    <span class="nx">pluck</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">property</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span> <span class="k">return</span> <span class="nx">el</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="nx">defaultDisplay</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">replaceWith</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newContent</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="nx">newContent</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">wrap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">structure</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="nx">isFunction</span><span class="p">(</span><span class="nx">structure</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">func</span><span class="p">)</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">dom</span>   <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">structure</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>            <span class="nx">clone</span> <span class="o">=</span> <span class="nx">dom</span><span class="p">.</span><span class="nx">parentNode</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">wrapAll</span><span class="p">(</span>
</span><span class='line'>          <span class="nx">func</span> <span class="o">?</span> <span class="nx">structure</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>            <span class="nx">clone</span> <span class="o">?</span> <span class="nx">dom</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="o">:</span> <span class="nx">dom</span>
</span><span class='line'>        <span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">wrapAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">structure</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">before</span><span class="p">(</span><span class="nx">structure</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">structure</span><span class="p">))</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">children</span>
</span><span class='line'>        <span class="c1">// drill down to the inmost element</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">((</span><span class="nx">children</span> <span class="o">=</span> <span class="nx">structure</span><span class="p">.</span><span class="nx">children</span><span class="p">()).</span><span class="nx">length</span><span class="p">)</span> <span class="nx">structure</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">first</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">structure</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">wrapInner</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">structure</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="nx">isFunction</span><span class="p">(</span><span class="nx">structure</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="nx">contents</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">contents</span><span class="p">(),</span>
</span><span class='line'>            <span class="nx">dom</span>  <span class="o">=</span> <span class="nx">func</span> <span class="o">?</span> <span class="nx">structure</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">:</span> <span class="nx">structure</span>
</span><span class='line'>        <span class="nx">contents</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">contents</span><span class="p">.</span><span class="nx">wrapAll</span><span class="p">(</span><span class="nx">dom</span><span class="p">)</span> <span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">dom</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">unwrap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">children</span><span class="p">())</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">clone</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">hide</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">toggle</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">setting</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>        <span class="p">;(</span><span class="nx">setting</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span> <span class="o">:</span> <span class="nx">setting</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">prev</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;previousElementSibling&#39;</span><span class="p">)).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">selector</span> <span class="o">||</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;nextElementSibling&#39;</span><span class="p">)).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">selector</span> <span class="o">||</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">html</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">0</span> <span class="k">in</span> <span class="nx">arguments</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">originHtml</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">innerHTML</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">empty</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">html</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">originHtml</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'>        <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>        <span class="p">(</span><span class="mi">0</span> <span class="k">in</span> <span class="k">this</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">text</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">0</span> <span class="k">in</span> <span class="nx">arguments</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">newText</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">textContent</span><span class="p">)</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">newText</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="o">+</span><span class="nx">newText</span>
</span><span class='line'>        <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>        <span class="p">(</span><span class="mi">0</span> <span class="k">in</span> <span class="k">this</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">textContent</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">attr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">result</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="mi">1</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">))</span> <span class="o">?</span>
</span><span class='line'>        <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">?</span> <span class="kc">undefined</span> <span class="o">:</span>
</span><span class='line'>          <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nx">name</span> <span class="k">in</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nx">name</span><span class="p">]</span> <span class="o">:</span> <span class="nx">result</span>
</span><span class='line'>        <span class="p">)</span> <span class="o">:</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">name</span><span class="p">)</span> <span class="nx">setAttribute</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">name</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span>
</span><span class='line'>          <span class="k">else</span> <span class="nx">setAttribute</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">name</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">removeAttr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">attribute</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">setAttribute</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">attribute</span><span class="p">)</span>
</span><span class='line'>      <span class="p">},</span> <span class="k">this</span><span class="p">)})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">prop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">name</span> <span class="o">=</span> <span class="nx">propMap</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">||</span> <span class="nx">name</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="k">this</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="k">this</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span>
</span><span class='line'>        <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>        <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nx">name</span><span class="p">])</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">data</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">attrName</span> <span class="o">=</span> <span class="s1">&#39;data-&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">capitalRE</span><span class="p">,</span> <span class="s1">&#39;-$1&#39;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attrName</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attrName</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="nx">data</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">deserializeValue</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">:</span> <span class="kc">undefined</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">val</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">0</span> <span class="k">in</span> <span class="nx">arguments</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>        <span class="p">})</span> <span class="o">:</span>
</span><span class='line'>        <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">multiple</span> <span class="o">?</span>
</span><span class='line'>           <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">selected</span> <span class="p">}).</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>           <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>        <span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">offset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">coordinates</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">coordinates</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
</span><span class='line'>            <span class="nx">coords</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">coordinates</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">offset</span><span class="p">()),</span>
</span><span class='line'>            <span class="nx">parentOffset</span> <span class="o">=</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">().</span><span class="nx">offset</span><span class="p">(),</span>
</span><span class='line'>            <span class="nx">props</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">top</span><span class="o">:</span>  <span class="nx">coords</span><span class="p">.</span><span class="nx">top</span>  <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">left</span><span class="o">:</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">left</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">$this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;static&#39;</span><span class="p">)</span> <span class="nx">props</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relative&#39;</span>
</span><span class='line'>        <span class="nx">$this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getBoundingClientRect</span><span class="p">()</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">left</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">pageXOffset</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">top</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">pageYOffset</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">width</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">width</span><span class="p">),</span>
</span><span class='line'>        <span class="nx">height</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">css</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">property</span><span class="p">,</span> <span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">computedStyle</span><span class="p">,</span> <span class="nx">element</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">element</span><span class="p">)</span> <span class="k">return</span>
</span><span class='line'>        <span class="nx">computedStyle</span> <span class="o">=</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">property</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">camelize</span><span class="p">(</span><span class="nx">property</span><span class="p">)]</span> <span class="o">||</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="nx">property</span><span class="p">)</span>
</span><span class='line'>        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">property</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">props</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>          <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">property</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">prop</span><span class="p">){</span>
</span><span class='line'>            <span class="nx">props</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">camelize</span><span class="p">(</span><span class="nx">prop</span><span class="p">)]</span> <span class="o">||</span> <span class="nx">computedStyle</span><span class="p">.</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">props</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">css</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">(</span><span class="nx">property</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">removeProperty</span><span class="p">(</span><span class="nx">dasherize</span><span class="p">(</span><span class="nx">property</span><span class="p">))</span> <span class="p">})</span>
</span><span class='line'>        <span class="k">else</span>
</span><span class='line'>          <span class="nx">css</span> <span class="o">=</span> <span class="nx">dasherize</span><span class="p">(</span><span class="nx">property</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">maybeAddPx</span><span class="p">(</span><span class="nx">property</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">property</span><span class="p">)</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">property</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">property</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">removeProperty</span><span class="p">(</span><span class="nx">dasherize</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">})</span>
</span><span class='line'>          <span class="k">else</span>
</span><span class='line'>            <span class="nx">css</span> <span class="o">+=</span> <span class="nx">dasherize</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">maybeAddPx</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">property</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">+=</span> <span class="s1">&#39;;&#39;</span> <span class="o">+</span> <span class="nx">css</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">index</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">element</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">children</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">hasClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">emptyArray</span><span class="p">.</span><span class="nx">some</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">className</span><span class="p">(</span><span class="nx">el</span><span class="p">))</span>
</span><span class='line'>      <span class="p">},</span> <span class="nx">classRE</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">addClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;className&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">))</span> <span class="k">return</span>
</span><span class='line'>        <span class="nx">classList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">cls</span> <span class="o">=</span> <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="nx">newName</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">cls</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">newName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">klass</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">klass</span><span class="p">))</span> <span class="nx">classList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">klass</span><span class="p">)</span>
</span><span class='line'>        <span class="p">},</span> <span class="k">this</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">classList</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">cls</span> <span class="o">+</span> <span class="p">(</span><span class="nx">cls</span> <span class="o">?</span> <span class="s2">&quot; &quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">classList</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">removeClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;className&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">))</span> <span class="k">return</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">classList</span> <span class="o">=</span> <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">classList</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">klass</span><span class="p">){</span>
</span><span class='line'>          <span class="nx">classList</span> <span class="o">=</span> <span class="nx">classList</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">classRE</span><span class="p">(</span><span class="nx">klass</span><span class="p">),</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>        <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">classList</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">toggleClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">when</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="nx">names</span> <span class="o">=</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">className</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">names</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">klass</span><span class="p">){</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">when</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="o">!</span><span class="nx">$this</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">klass</span><span class="p">)</span> <span class="o">:</span> <span class="nx">when</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>            <span class="nx">$this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">klass</span><span class="p">)</span> <span class="o">:</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">klass</span><span class="p">)</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">scrollTop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">hasScrollTop</span> <span class="o">=</span> <span class="s1">&#39;scrollTop&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">hasScrollTop</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">:</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageYOffset</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">hasScrollTop</span> <span class="o">?</span>
</span><span class='line'>        <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">value</span> <span class="p">}</span> <span class="o">:</span>
</span><span class='line'>        <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollX</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">scrollLeft</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">hasScrollLeft</span> <span class="o">=</span> <span class="s1">&#39;scrollLeft&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">hasScrollLeft</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollLeft</span> <span class="o">:</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageXOffset</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">hasScrollLeft</span> <span class="o">?</span>
</span><span class='line'>        <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">=</span> <span class="nx">value</span> <span class="p">}</span> <span class="o">:</span>
</span><span class='line'>        <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollY</span><span class="p">)</span> <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">position</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span class='line'>        <span class="c1">// Get *real* offsetParent</span>
</span><span class='line'>        <span class="nx">offsetParent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">(),</span>
</span><span class='line'>        <span class="c1">// Get correct offsets</span>
</span><span class='line'>        <span class="nx">offset</span>       <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span>
</span><span class='line'>        <span class="nx">parentOffset</span> <span class="o">=</span> <span class="nx">rootNodeRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">)</span> <span class="o">?</span> <span class="p">{</span> <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span> <span class="p">}</span> <span class="o">:</span> <span class="nx">offsetParent</span><span class="p">.</span><span class="nx">offset</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Subtract element margins</span>
</span><span class='line'>      <span class="c1">// note: when an element has margin: auto the offsetLeft and marginLeft</span>
</span><span class='line'>      <span class="c1">// are the same in Safari causing offset.left to incorrectly be 0</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="nx">elem</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;margin-top&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span>
</span><span class='line'>      <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="nx">elem</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;margin-left&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Add offsetParent borders</span>
</span><span class='line'>      <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;border-top-width&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span>
</span><span class='line'>      <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+=</span> <span class="nb">parseFloat</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="nx">offsetParent</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;border-left-width&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Subtract the two offsets</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">top</span><span class="o">:</span>  <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span>  <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">left</span><span class="o">:</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">parentOffset</span><span class="p">.</span><span class="nx">left</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">offsetParent</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">rootNodeRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">parent</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;static&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="nx">parent</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">offsetParent</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">parent</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// for now</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">detach</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">remove</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Generate the `width` and `height` functions</span>
</span><span class='line'>  <span class="p">;[</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">dimension</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">dimensionProperty</span> <span class="o">=</span>
</span><span class='line'>      <span class="nx">dimension</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/./</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">m</span><span class="p">){</span> <span class="k">return</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">dimension</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">return</span> <span class="nx">isWindow</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span><span class="p">[</span><span class="s1">&#39;inner&#39;</span> <span class="o">+</span> <span class="nx">dimensionProperty</span><span class="p">]</span> <span class="o">:</span>
</span><span class='line'>        <span class="nx">isDocument</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s1">&#39;scroll&#39;</span> <span class="o">+</span> <span class="nx">dimensionProperty</span><span class="p">]</span> <span class="o">:</span>
</span><span class='line'>        <span class="p">(</span><span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">())</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span><span class="p">[</span><span class="nx">dimension</span><span class="p">]</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">el</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">dimension</span><span class="p">,</span> <span class="nx">funcArg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">el</span><span class="p">[</span><span class="nx">dimension</span><span class="p">]()))</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">traverseNode</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">fun</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">fun</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">traverseNode</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">fun</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Generate the `after`, `prepend`, `before`, `append`,</span>
</span><span class='line'>  <span class="c1">// `insertAfter`, `insertBefore`, `appendTo`, and `prependTo` methods.</span>
</span><span class='line'>  <span class="nx">adjacencyOperators</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">operator</span><span class="p">,</span> <span class="nx">operatorIndex</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">inside</span> <span class="o">=</span> <span class="nx">operatorIndex</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1">//=&gt; prepend, append</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">operator</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="c1">// arguments can be nodes, arrays of nodes, Zepto objects and HTML strings</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">argType</span><span class="p">,</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">argType</span> <span class="o">=</span> <span class="nx">type</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">argType</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span> <span class="o">||</span> <span class="nx">argType</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span> <span class="o">||</span> <span class="nx">arg</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
</span><span class='line'>              <span class="nx">arg</span> <span class="o">:</span> <span class="nx">zepto</span><span class="p">.</span><span class="nx">fragment</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span>
</span><span class='line'>          <span class="p">}),</span>
</span><span class='line'>          <span class="nx">parent</span><span class="p">,</span> <span class="nx">copyByClone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">target</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">parent</span> <span class="o">=</span> <span class="nx">inside</span> <span class="o">?</span> <span class="nx">target</span> <span class="o">:</span> <span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// convert all methods to a &quot;before&quot; operation</span>
</span><span class='line'>        <span class="nx">target</span> <span class="o">=</span> <span class="nx">operatorIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">target</span><span class="p">.</span><span class="nx">nextSibling</span> <span class="o">:</span>
</span><span class='line'>                 <span class="nx">operatorIndex</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">target</span><span class="p">.</span><span class="nx">firstChild</span> <span class="o">:</span>
</span><span class='line'>                 <span class="nx">operatorIndex</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">?</span> <span class="nx">target</span> <span class="o">:</span>
</span><span class='line'>                 <span class="kc">null</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">parentInDocument</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">nodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">copyByClone</span><span class="p">)</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span><span class='line'>          <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">parent</span><span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">node</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">parentInDocument</span><span class="p">)</span> <span class="nx">traverseNode</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;SCRIPT&#39;</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>               <span class="p">(</span><span class="o">!</span><span class="nx">el</span><span class="p">.</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">el</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">el</span><span class="p">.</span><span class="nx">src</span><span class="p">)</span>
</span><span class='line'>              <span class="nb">window</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">)</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// after    =&gt; insertAfter</span>
</span><span class='line'>    <span class="c1">// prepend  =&gt; prependTo</span>
</span><span class='line'>    <span class="c1">// before   =&gt; insertBefore</span>
</span><span class='line'>    <span class="c1">// append   =&gt; appendTo</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">inside</span> <span class="o">?</span> <span class="nx">operator</span><span class="o">+</span><span class="s1">&#39;To&#39;</span> <span class="o">:</span> <span class="s1">&#39;insert&#39;</span><span class="o">+</span><span class="p">(</span><span class="nx">operatorIndex</span> <span class="o">?</span> <span class="s1">&#39;Before&#39;</span> <span class="o">:</span> <span class="s1">&#39;After&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">html</span><span class="p">)[</span><span class="nx">operator</span><span class="p">](</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">Z</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Export internal API functions in the `$.zepto` namespace</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">uniq</span> <span class="o">=</span> <span class="nx">uniq</span>
</span><span class='line'>  <span class="nx">zepto</span><span class="p">.</span><span class="nx">deserializeValue</span> <span class="o">=</span> <span class="nx">deserializeValue</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">zepto</span> <span class="o">=</span> <span class="nx">zepto</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">$</span>
</span><span class='line'><span class="p">})()</span>
</span><span class='line'>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">Zepto</span> <span class="o">=</span> <span class="nx">Zepto</span>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">Zepto</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">_zid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">slice</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">isFunction</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">isString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">handlers</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>      <span class="nx">specialEvents</span><span class="o">=</span><span class="p">{},</span>
</span><span class='line'>      <span class="nx">focusinSupported</span> <span class="o">=</span> <span class="s1">&#39;onfocusin&#39;</span> <span class="k">in</span> <span class="nb">window</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">focus</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">focus</span><span class="o">:</span> <span class="s1">&#39;focusin&#39;</span><span class="p">,</span> <span class="nx">blur</span><span class="o">:</span> <span class="s1">&#39;focusout&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">hover</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">mouseenter</span><span class="o">:</span> <span class="s1">&#39;mouseover&#39;</span><span class="p">,</span> <span class="nx">mouseleave</span><span class="o">:</span> <span class="s1">&#39;mouseout&#39;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">specialEvents</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="nx">specialEvents</span><span class="p">.</span><span class="nx">mousedown</span> <span class="o">=</span> <span class="nx">specialEvents</span><span class="p">.</span><span class="nx">mouseup</span> <span class="o">=</span> <span class="nx">specialEvents</span><span class="p">.</span><span class="nx">mousemove</span> <span class="o">=</span> <span class="s1">&#39;MouseEvents&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">_zid</span> <span class="o">||</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">_zid</span> <span class="o">=</span> <span class="nx">_zid</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">findHandlers</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">event</span> <span class="o">=</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ns</span><span class="p">)</span> <span class="kd">var</span> <span class="nx">matcher</span> <span class="o">=</span> <span class="nx">matcherFor</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">ns</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span><span class="nx">handlers</span><span class="p">[</span><span class="nx">zid</span><span class="p">(</span><span class="nx">element</span><span class="p">)]</span> <span class="o">||</span> <span class="p">[]).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">handler</span>
</span><span class='line'>        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">e</span>  <span class="o">||</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">e</span> <span class="o">==</span> <span class="nx">event</span><span class="p">.</span><span class="nx">e</span><span class="p">)</span>
</span><span class='line'>        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">ns</span> <span class="o">||</span> <span class="nx">matcher</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">ns</span><span class="p">))</span>
</span><span class='line'>        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">fn</span>       <span class="o">||</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">fn</span><span class="p">)</span> <span class="o">===</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">fn</span><span class="p">))</span>
</span><span class='line'>        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">selector</span> <span class="o">||</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">sel</span> <span class="o">==</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span><span class="nx">e</span><span class="o">:</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">ns</span><span class="o">:</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">sort</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">matcherFor</span><span class="p">(</span><span class="nx">ns</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(?:^| )&#39;</span> <span class="o">+</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39; .* ?&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;(?: |$)&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">eventCapture</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">captureSetting</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">del</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>      <span class="p">(</span><span class="o">!</span><span class="nx">focusinSupported</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">e</span> <span class="k">in</span> <span class="nx">focus</span><span class="p">))</span> <span class="o">||</span>
</span><span class='line'>      <span class="o">!!</span><span class="nx">captureSetting</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">realEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">hover</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">focusinSupported</span> <span class="o">&amp;&amp;</span> <span class="nx">focus</span><span class="p">[</span><span class="nx">type</span><span class="p">])</span> <span class="o">||</span> <span class="nx">type</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">delegator</span><span class="p">,</span> <span class="nx">capture</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">element</span><span class="p">),</span> <span class="nx">set</span> <span class="o">=</span> <span class="p">(</span><span class="nx">handlers</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">handlers</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]))</span>
</span><span class='line'>    <span class="nx">events</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">==</span> <span class="s1">&#39;ready&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">handler</span>   <span class="o">=</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">handler</span><span class="p">.</span><span class="nx">fn</span>    <span class="o">=</span> <span class="nx">fn</span>
</span><span class='line'>      <span class="nx">handler</span><span class="p">.</span><span class="nx">sel</span>   <span class="o">=</span> <span class="nx">selector</span>
</span><span class='line'>      <span class="c1">// emulate mouseenter, mouseleave</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">e</span> <span class="k">in</span> <span class="nx">hover</span><span class="p">)</span> <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">related</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">relatedTarget</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">related</span> <span class="o">||</span> <span class="p">(</span><span class="nx">related</span> <span class="o">!==</span> <span class="k">this</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">related</span><span class="p">)))</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">handler</span><span class="p">.</span><span class="nx">del</span>   <span class="o">=</span> <span class="nx">delegator</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">callback</span>  <span class="o">=</span> <span class="nx">delegator</span> <span class="o">||</span> <span class="nx">fn</span>
</span><span class='line'>      <span class="nx">handler</span><span class="p">.</span><span class="nx">proxy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">e</span> <span class="o">=</span> <span class="nx">compatible</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">isImmediatePropagationStopped</span><span class="p">())</span> <span class="k">return</span>
</span><span class='line'>        <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">_args</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="p">[</span><span class="nx">e</span><span class="p">]</span> <span class="o">:</span> <span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">_args</span><span class="p">))</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">(),</span> <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">result</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">handler</span><span class="p">.</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">set</span><span class="p">.</span><span class="nx">length</span>
</span><span class='line'>      <span class="nx">set</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">handler</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;addEventListener&#39;</span> <span class="k">in</span> <span class="nx">element</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">realEvent</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">e</span><span class="p">),</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">proxy</span><span class="p">,</span> <span class="nx">eventCapture</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">capture</span><span class="p">))</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">remove</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">capture</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>    <span class="p">;(</span><span class="nx">events</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">findHandlers</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">selector</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">handler</span><span class="p">){</span>
</span><span class='line'>        <span class="k">delete</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">id</span><span class="p">][</span><span class="nx">handler</span><span class="p">.</span><span class="nx">i</span><span class="p">]</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;removeEventListener&#39;</span> <span class="k">in</span> <span class="nx">element</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">element</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">realEvent</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">e</span><span class="p">),</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">proxy</span><span class="p">,</span> <span class="nx">eventCapture</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">capture</span><span class="p">))</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">event</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">add</span><span class="o">:</span> <span class="nx">add</span><span class="p">,</span> <span class="nx">remove</span><span class="o">:</span> <span class="nx">remove</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">proxy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">fn</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">proxyFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span> <span class="o">?</span> <span class="nx">args</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">))</span> <span class="o">:</span> <span class="nx">arguments</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>      <span class="nx">proxyFn</span><span class="p">.</span><span class="nx">_zid</span> <span class="o">=</span> <span class="nx">zid</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">proxyFn</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isString</span><span class="p">(</span><span class="nx">context</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">fn</span><span class="p">[</span><span class="nx">context</span><span class="p">],</span> <span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">proxy</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span><span class="nx">fn</span><span class="p">[</span><span class="nx">context</span><span class="p">],</span> <span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s2">&quot;expected function&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">bind</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">unbind</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">one</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">returnTrue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="kc">true</span><span class="p">},</span>
</span><span class='line'>      <span class="nx">returnFalse</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="kc">false</span><span class="p">},</span>
</span><span class='line'>      <span class="nx">ignoreProperties</span> <span class="o">=</span> <span class="sr">/^([A-Z]|returnValue$|layer[XY]$)/</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">eventMethods</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">preventDefault</span><span class="o">:</span> <span class="s1">&#39;isDefaultPrevented&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">stopImmediatePropagation</span><span class="o">:</span> <span class="s1">&#39;isImmediatePropagationStopped&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">stopPropagation</span><span class="o">:</span> <span class="s1">&#39;isPropagationStopped&#39;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">compatible</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">source</span> <span class="o">||</span> <span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">source</span> <span class="o">||</span> <span class="p">(</span><span class="nx">source</span> <span class="o">=</span> <span class="nx">event</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">eventMethods</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">sourceMethod</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>
</span><span class='line'>        <span class="nx">event</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="k">this</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">returnTrue</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">sourceMethod</span> <span class="o">&amp;&amp;</span> <span class="nx">sourceMethod</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">event</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">returnFalse</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">defaultPrevented</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">source</span><span class="p">.</span><span class="nx">defaultPrevented</span> <span class="o">:</span>
</span><span class='line'>          <span class="s1">&#39;returnValue&#39;</span> <span class="k">in</span> <span class="nx">source</span> <span class="o">?</span> <span class="nx">source</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">:</span>
</span><span class='line'>          <span class="nx">source</span><span class="p">.</span><span class="nx">getPreventDefault</span> <span class="o">&amp;&amp;</span> <span class="nx">source</span><span class="p">.</span><span class="nx">getPreventDefault</span><span class="p">())</span>
</span><span class='line'>        <span class="nx">event</span><span class="p">.</span><span class="nx">isDefaultPrevented</span> <span class="o">=</span> <span class="nx">returnTrue</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">event</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">createProxy</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">originalEvent</span><span class="o">:</span> <span class="nx">event</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">event</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ignoreProperties</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">proxy</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">event</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">compatible</span><span class="p">(</span><span class="nx">proxy</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">delegate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">undelegate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">live</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">delegate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">die</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">undelegate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">one</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">autoRemove</span><span class="p">,</span> <span class="nx">delegator</span><span class="p">,</span> <span class="nx">$this</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">event</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">$this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">one</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$this</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">selector</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">||</span> <span class="nx">data</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">returnFalse</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">element</span><span class="p">){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">one</span><span class="p">)</span> <span class="nx">autoRemove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">remove</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="nx">delegator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">evt</span><span class="p">,</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">closest</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">element</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">match</span> <span class="o">&amp;&amp;</span> <span class="nx">match</span> <span class="o">!==</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">evt</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">createProxy</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span> <span class="p">{</span><span class="nx">currentTarget</span><span class="o">:</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">liveFired</span><span class="o">:</span> <span class="nx">element</span><span class="p">})</span>
</span><span class='line'>          <span class="k">return</span> <span class="p">(</span><span class="nx">autoRemove</span> <span class="o">||</span> <span class="nx">callback</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="p">[</span><span class="nx">evt</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">add</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">delegator</span> <span class="o">||</span> <span class="nx">autoRemove</span><span class="p">)</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">off</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">event</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">$this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$this</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">selector</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">returnFalse</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">trigger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">args</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">event</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isString</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">||</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">event</span><span class="p">))</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">:</span> <span class="nx">compatible</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">event</span><span class="p">.</span><span class="nx">_args</span> <span class="o">=</span> <span class="nx">args</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="c1">// handle focus(), blur() by calling them directly</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="k">in</span> <span class="nx">focus</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="k">this</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="k">this</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">]()</span>
</span><span class='line'>      <span class="c1">// items in the collection might not be DOM elements</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dispatchEvent&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>      <span class="k">else</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">triggerHandler</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// triggers event handlers on current element just as if an event occurred,</span>
</span><span class='line'>  <span class="c1">// doesn&#39;t trigger an actual event, doesn&#39;t bubble</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">triggerHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">args</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">result</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">element</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">e</span> <span class="o">=</span> <span class="nx">createProxy</span><span class="p">(</span><span class="nx">isString</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">:</span> <span class="nx">event</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">e</span><span class="p">.</span><span class="nx">_args</span> <span class="o">=</span> <span class="nx">args</span>
</span><span class='line'>      <span class="nx">e</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">element</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">findHandlers</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">event</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">handler</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">result</span> <span class="o">=</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">isImmediatePropagationStopped</span><span class="p">())</span> <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">result</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// shortcut methods for `.bind(event, fn)` for each event type</span>
</span><span class='line'>  <span class="p">;(</span><span class="s1">&#39;focusin focusout focus blur load resize scroll unload click dblclick &#39;</span><span class="o">+</span>
</span><span class='line'>  <span class="s1">&#39;mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave &#39;</span><span class="o">+</span>
</span><span class='line'>  <span class="s1">&#39;change select keydown keypress keyup error&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="mi">0</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">Event</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isString</span><span class="p">(</span><span class="nx">type</span><span class="p">))</span> <span class="nx">props</span> <span class="o">=</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">type</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="nx">specialEvents</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;Events&#39;</span><span class="p">),</span> <span class="nx">bubbles</span> <span class="o">=</span> <span class="kc">true</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">props</span><span class="p">)</span> <span class="p">(</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;bubbles&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">bubbles</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">props</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="o">:</span> <span class="p">(</span><span class="nx">event</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">event</span><span class="p">.</span><span class="nx">initEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">bubbles</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">compatible</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">})(</span><span class="nx">Zepto</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">jsonpID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>      <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">key</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">name</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">rscript</span> <span class="o">=</span> <span class="sr">/&lt;script\b[^&lt;]*(?:(?!&lt;\/script&gt;)&lt;[^&lt;]*)*&lt;\/script&gt;/gi</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">scriptTypeRE</span> <span class="o">=</span> <span class="sr">/^(?:text|application)\/javascript/i</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">xmlTypeRE</span> <span class="o">=</span> <span class="sr">/^(?:text|application)\/xml/i</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">jsonType</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">htmlType</span> <span class="o">=</span> <span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">blankRE</span> <span class="o">=</span> <span class="sr">/^\s*$/</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">originAnchor</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">originAnchor</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// trigger a custom event and return false if it was cancelled</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">triggerAndReturn</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">eventName</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nx">context</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="p">()</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// trigger an Ajax &quot;global&quot; event</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">global</span><span class="p">)</span> <span class="k">return</span> <span class="nx">triggerAndReturn</span><span class="p">(</span><span class="nx">context</span> <span class="o">||</span> <span class="nb">document</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Number of active Ajax requests</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">active</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxStart</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">global</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">active</span><span class="o">++</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;ajaxStart&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxStop</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">global</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="o">--</span><span class="nx">$</span><span class="p">.</span><span class="nx">active</span><span class="p">))</span> <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;ajaxStop&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// triggers an extra global event &quot;ajaxBeforeSend&quot; that&#39;s like &quot;ajaxSend&quot; but cancelable</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxBeforeSend</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">context</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">beforeSend</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span>
</span><span class='line'>        <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="s1">&#39;ajaxBeforeSend&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">])</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="s1">&#39;ajaxSend&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">])</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxSuccess</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="nx">status</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
</span><span class='line'>    <span class="nx">settings</span><span class="p">.</span><span class="nx">success</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">deferred</span><span class="p">)</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="s1">&#39;ajaxSuccess&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">data</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">ajaxComplete</span><span class="p">(</span><span class="nx">status</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="c1">// type: &quot;timeout&quot;, &quot;error&quot;, &quot;abort&quot;, &quot;parsererror&quot;</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxError</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">context</span>
</span><span class='line'>    <span class="nx">settings</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">deferred</span><span class="p">)</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">rejectWith</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">error</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="s1">&#39;ajaxError&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">error</span> <span class="o">||</span> <span class="nx">type</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">ajaxComplete</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="c1">// status: &quot;success&quot;, &quot;notmodified&quot;, &quot;error&quot;, &quot;timeout&quot;, &quot;abort&quot;, &quot;parsererror&quot;</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">ajaxComplete</span><span class="p">(</span><span class="nx">status</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">context</span>
</span><span class='line'>    <span class="nx">settings</span><span class="p">.</span><span class="nx">complete</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">triggerGlobal</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="s1">&#39;ajaxComplete&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">ajaxStop</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Empty function, used as default callback</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">empty</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxJSONP</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">){</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">_callbackName</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">callbackName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">_callbackName</span><span class="p">)</span> <span class="o">?</span>
</span><span class='line'>        <span class="nx">_callbackName</span><span class="p">()</span> <span class="o">:</span> <span class="nx">_callbackName</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="s1">&#39;jsonp&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="o">++</span><span class="nx">jsonpID</span><span class="p">)),</span>
</span><span class='line'>      <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">originalCallback</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="nx">callbackName</span><span class="p">],</span>
</span><span class='line'>      <span class="nx">responseData</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">abort</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">errorType</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">script</span><span class="p">).</span><span class="nx">triggerHandler</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">errorType</span> <span class="o">||</span> <span class="s1">&#39;abort&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">xhr</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">abort</span><span class="o">:</span> <span class="nx">abort</span> <span class="p">},</span> <span class="nx">abortTimeout</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">deferred</span><span class="p">)</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nx">script</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;load error&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">errorType</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">abortTimeout</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">script</span><span class="p">).</span><span class="nx">off</span><span class="p">().</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;error&#39;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">responseData</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">ajaxError</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">errorType</span> <span class="o">||</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">ajaxSuccess</span><span class="p">(</span><span class="nx">responseData</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="nb">window</span><span class="p">[</span><span class="nx">callbackName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">originalCallback</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">responseData</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">originalCallback</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">originalCallback</span><span class="p">(</span><span class="nx">responseData</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">originalCallback</span> <span class="o">=</span> <span class="nx">responseData</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">ajaxBeforeSend</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">abort</span><span class="p">(</span><span class="s1">&#39;abort&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">xhr</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">window</span><span class="p">[</span><span class="nx">callbackName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="nx">responseData</span> <span class="o">=</span> <span class="nx">arguments</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\?(.+)=\?/</span><span class="p">,</span> <span class="s1">&#39;?$1=&#39;</span> <span class="o">+</span> <span class="nx">callbackName</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">abortTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="nx">abort</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span> <span class="nx">options</span><span class="p">.</span><span class="nx">timeout</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">xhr</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxSettings</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Default type of request</span>
</span><span class='line'>    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Callback that is executed before request</span>
</span><span class='line'>    <span class="nx">beforeSend</span><span class="o">:</span> <span class="nx">empty</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Callback that is executed if the request succeeds</span>
</span><span class='line'>    <span class="nx">success</span><span class="o">:</span> <span class="nx">empty</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Callback that is executed the the server drops error</span>
</span><span class='line'>    <span class="nx">error</span><span class="o">:</span> <span class="nx">empty</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Callback that is executed on request complete (both: error and success)</span>
</span><span class='line'>    <span class="nx">complete</span><span class="o">:</span> <span class="nx">empty</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// The context for the callbacks</span>
</span><span class='line'>    <span class="nx">context</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Whether to trigger &quot;global&quot; Ajax events</span>
</span><span class='line'>    <span class="nx">global</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Transport</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">()</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="c1">// MIME types mapping</span>
</span><span class='line'>    <span class="c1">// IIS returns Javascript as &quot;application/x-javascript&quot;</span>
</span><span class='line'>    <span class="nx">accepts</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">script</span><span class="o">:</span> <span class="s1">&#39;text/javascript, application/javascript, application/x-javascript&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">json</span><span class="o">:</span>   <span class="nx">jsonType</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">xml</span><span class="o">:</span>    <span class="s1">&#39;application/xml, text/xml&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">html</span><span class="o">:</span>   <span class="nx">htmlType</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">text</span><span class="o">:</span>   <span class="s1">&#39;text/plain&#39;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="c1">// Whether the request is to another domain</span>
</span><span class='line'>    <span class="nx">crossDomain</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Default timeout</span>
</span><span class='line'>    <span class="nx">timeout</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Whether data should be serialized to string</span>
</span><span class='line'>    <span class="nx">processData</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Whether the browser should be allowed to cache GET responses</span>
</span><span class='line'>    <span class="nx">cache</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">mimeToDataType</span><span class="p">(</span><span class="nx">mime</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">mime</span><span class="p">)</span> <span class="nx">mime</span> <span class="o">=</span> <span class="nx">mime</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">mime</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">mime</span> <span class="o">==</span> <span class="nx">htmlType</span> <span class="o">?</span> <span class="s1">&#39;html&#39;</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">mime</span> <span class="o">==</span> <span class="nx">jsonType</span> <span class="o">?</span> <span class="s1">&#39;json&#39;</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">scriptTypeRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">mime</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;script&#39;</span> <span class="o">:</span>
</span><span class='line'>      <span class="nx">xmlTypeRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">mime</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;xml&#39;</span> <span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;text&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">appendQuery</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="nx">url</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span><span class="nx">url</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="nx">query</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&amp;?]{1,2}/</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// serialize payload and append it to the URL for GET requests</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">serializeData</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">processData</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">traditional</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">))</span>
</span><span class='line'>      <span class="nx">options</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">appendQuery</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">),</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{}),</span>
</span><span class='line'>        <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(),</span>
</span><span class='line'>        <span class="nx">urlAnchor</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">settings</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">ajaxStart</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">settings</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">urlAnchor</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">urlAnchor</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span>
</span><span class='line'>      <span class="nx">urlAnchor</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">urlAnchor</span><span class="p">.</span><span class="nx">href</span>
</span><span class='line'>      <span class="nx">settings</span><span class="p">.</span><span class="nx">crossDomain</span> <span class="o">=</span> <span class="p">(</span><span class="nx">originAnchor</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s1">&#39;//&#39;</span> <span class="o">+</span> <span class="nx">originAnchor</span><span class="p">.</span><span class="nx">host</span><span class="p">)</span> <span class="o">!==</span> <span class="p">(</span><span class="nx">urlAnchor</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s1">&#39;//&#39;</span> <span class="o">+</span> <span class="nx">urlAnchor</span><span class="p">.</span><span class="nx">host</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
</span><span class='line'>    <span class="nx">serializeData</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">dataType</span><span class="p">,</span> <span class="nx">hasPlaceholder</span> <span class="o">=</span> <span class="sr">/\?.+=\?/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">hasPlaceholder</span><span class="p">)</span> <span class="nx">dataType</span> <span class="o">=</span> <span class="s1">&#39;jsonp&#39;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">cache</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="p">(</span>
</span><span class='line'>         <span class="p">(</span><span class="o">!</span><span class="nx">options</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">cache</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>         <span class="p">(</span><span class="s1">&#39;script&#39;</span> <span class="o">==</span> <span class="nx">dataType</span> <span class="o">||</span> <span class="s1">&#39;jsonp&#39;</span> <span class="o">==</span> <span class="nx">dataType</span><span class="p">)</span>
</span><span class='line'>        <span class="p">))</span>
</span><span class='line'>      <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">appendQuery</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="s1">&#39;_=&#39;</span> <span class="o">+</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;jsonp&#39;</span> <span class="o">==</span> <span class="nx">dataType</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasPlaceholder</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">appendQuery</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">settings</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">?</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">+</span> <span class="s1">&#39;=?&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">jsonp</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;callback=?&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxJSONP</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">mime</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span><span class="nx">dataType</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="p">},</span>
</span><span class='line'>        <span class="nx">setHeader</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="p">},</span>
</span><span class='line'>        <span class="nx">protocol</span> <span class="o">=</span> <span class="sr">/^([\w-]+:)\/\//</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">?</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">xhr</span><span class="p">(),</span>
</span><span class='line'>        <span class="nx">nativeSetHeader</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">abortTimeout</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">deferred</span><span class="p">)</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">settings</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">)</span> <span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;X-Requested-With&#39;</span><span class="p">,</span> <span class="s1">&#39;XMLHttpRequest&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;Accept&#39;</span><span class="p">,</span> <span class="nx">mime</span> <span class="o">||</span> <span class="s1">&#39;*/*&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">mime</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">mimeType</span> <span class="o">||</span> <span class="nx">mime</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">mime</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">mime</span> <span class="o">=</span> <span class="nx">mime</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>      <span class="nx">xhr</span><span class="p">.</span><span class="nx">overrideMimeType</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="p">(</span><span class="nx">mime</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">||</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;GET&#39;</span><span class="p">))</span>
</span><span class='line'>      <span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">||</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span> <span class="nx">setHeader</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span> <span class="o">=</span> <span class="nx">setHeader</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">empty</span>
</span><span class='line'>        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">abortTimeout</span><span class="p">)</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">error</span> <span class="o">=</span> <span class="kc">false</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">((</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)</span> <span class="o">||</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">304</span> <span class="o">||</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">protocol</span> <span class="o">==</span> <span class="s1">&#39;file:&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">dataType</span> <span class="o">||</span> <span class="nx">mimeToDataType</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">mimeType</span> <span class="o">||</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">))</span>
</span><span class='line'>          <span class="nx">result</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>            <span class="c1">// http://perfectionkills.com/global-eval-what-are-the-options/</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="nx">dataType</span> <span class="o">==</span> <span class="s1">&#39;script&#39;</span><span class="p">)</span>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">eval</span><span class="p">)(</span><span class="nx">result</span><span class="p">)</span>
</span><span class='line'>            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">dataType</span> <span class="o">==</span> <span class="s1">&#39;xml&#39;</span><span class="p">)</span>  <span class="nx">result</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseXML</span>
</span><span class='line'>            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">dataType</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">)</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">blankRE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
</span><span class='line'>          <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="nx">ajaxError</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="s1">&#39;parsererror&#39;</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>          <span class="k">else</span> <span class="nx">ajaxSuccess</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">ajaxError</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">statusText</span> <span class="o">||</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">?</span> <span class="s1">&#39;error&#39;</span> <span class="o">:</span> <span class="s1">&#39;abort&#39;</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">ajaxBeforeSend</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">()</span>
</span><span class='line'>      <span class="nx">ajaxError</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;abort&#39;</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">xhr</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span> <span class="nx">xhr</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="s1">&#39;async&#39;</span> <span class="k">in</span> <span class="nx">settings</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">async</span> <span class="o">:</span> <span class="kc">true</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">async</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">headers</span><span class="p">)</span> <span class="nx">nativeSetHeader</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">abortTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">empty</span>
</span><span class='line'>        <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">ajaxError</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">deferred</span><span class="p">)</span>
</span><span class='line'>      <span class="p">},</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">timeout</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// avoid sending empty string (#319)</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">data</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">data</span> <span class="o">:</span> <span class="kc">null</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">xhr</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// handle optional data/success arguments</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">parseArguments</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">dataType</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">success</span><span class="p">))</span> <span class="nx">dataType</span> <span class="o">=</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">success</span> <span class="o">=</span> <span class="kc">undefined</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">url</span><span class="o">:</span> <span class="nx">url</span>
</span><span class='line'>    <span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span>
</span><span class='line'>    <span class="p">,</span> <span class="nx">success</span><span class="o">:</span> <span class="nx">success</span>
</span><span class='line'>    <span class="p">,</span> <span class="nx">dataType</span><span class="o">:</span> <span class="nx">dataType</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="cm">/* url, data, success, dataType */</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">parseArguments</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">))</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="cm">/* url, data, success, dataType */</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">parseArguments</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">options</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;POST&#39;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="cm">/* url, data, success */</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">parseArguments</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">options</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">load</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">success</span><span class="p">){</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">),</span> <span class="nx">selector</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">options</span> <span class="o">=</span> <span class="nx">parseArguments</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">success</span><span class="p">),</span>
</span><span class='line'>        <span class="nx">callback</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">options</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">selector</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>    <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">self</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">selector</span> <span class="o">?</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rscript</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)).</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span>
</span><span class='line'>        <span class="o">:</span> <span class="nx">response</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">escape</span> <span class="o">=</span> <span class="nb">encodeURIComponent</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">serialize</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">scope</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">type</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">scope</span><span class="p">)</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">traditional</span> <span class="o">?</span> <span class="nx">scope</span> <span class="o">:</span>
</span><span class='line'>        <span class="nx">scope</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">hash</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span> <span class="o">?</span> <span class="nx">key</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
</span><span class='line'>      <span class="c1">// handle data in serializeArray() format</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">scope</span> <span class="o">&amp;&amp;</span> <span class="nx">array</span><span class="p">)</span> <span class="nx">params</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">// recurse into nested objects</span>
</span><span class='line'>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">traditional</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">))</span>
</span><span class='line'>        <span class="nx">serialize</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span>
</span><span class='line'>      <span class="k">else</span> <span class="nx">params</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">param</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="nx">params</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">()</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">escape</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">serialize</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">traditional</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/%20/g</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})(</span><span class="nx">Zepto</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">serializeArray</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>      <span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">forEach</span><span class="p">)</span> <span class="k">return</span> <span class="nx">value</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">add</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="nx">value</span> <span class="p">})</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">elements</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">field</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">type</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">name</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="nx">field</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;fieldset&#39;</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>        <span class="o">!</span><span class="nx">field</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;submit&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;reset&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;button&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;file&#39;</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>        <span class="p">((</span><span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;radio&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;checkbox&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">field</span><span class="p">.</span><span class="nx">checked</span><span class="p">))</span>
</span><span class='line'>          <span class="nx">add</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">field</span><span class="p">).</span><span class="nx">val</span><span class="p">())</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">result</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">serialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">serializeArray</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elm</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">elm</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">elm</span><span class="p">.</span><span class="nx">value</span><span class="p">))</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">submit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="k">in</span> <span class="nx">arguments</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</span><span class='line'>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="p">())</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">submit</span><span class="p">()</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">})(</span><span class="nx">Zepto</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="c1">// __proto__ doesn&#39;t exist on IE&lt;11, so redefine</span>
</span><span class='line'>  <span class="c1">// the Z function to use object extension instead</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;__proto__&#39;</span> <span class="k">in</span> <span class="p">{}))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">zepto</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">Z</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dom</span><span class="p">,</span> <span class="nx">selector</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">dom</span> <span class="o">=</span> <span class="nx">dom</span> <span class="o">||</span> <span class="p">[]</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">dom</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">dom</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>        <span class="nx">dom</span><span class="p">.</span><span class="nx">__Z</span> <span class="o">=</span> <span class="kc">true</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">dom</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="c1">// this is a kludge but works</span>
</span><span class='line'>      <span class="nx">isZ</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;array&#39;</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;__Z&#39;</span> <span class="k">in</span> <span class="nx">object</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// getComputedStyle shouldn&#39;t freak out when called</span>
</span><span class='line'>  <span class="c1">// without a valid element as argument</span>
</span><span class='line'>  <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">getComputedStyle</span><span class="p">(</span><span class="kc">undefined</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">nativeGetComputedStyle</span> <span class="o">=</span> <span class="nx">getComputedStyle</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
</span><span class='line'>      <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">nativeGetComputedStyle</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="kc">null</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})(</span><span class="nx">Zepto</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>

  
  <section>
    <h1>Comments</h1>
    <div id="disqus_thread"><div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'mirreal';
  var disqus_identifier = 'http://blog.mirreal.net/code/zepto.html';
  var disqus_url = 'http://blog.mirreal.net/code/zepto.html';
  //var disqus_developer = 1;
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>
  
</article>

       <footer role="contentinfo" class="copyright">
    	<p>
		Copyright &copy; 2017 - <span><a href="http://mirreal.net/">Patrick Ran</a></span>
	</p>
    </footer>

  </div>

</body>
</html>

